# 第三方依赖说明

## 文档信息

| 项目 | 内容 |
|------|------|
| 文档版本 | V1.0 |
| 文档状态 | 已完成 |
| 创建日期 | 2026-02-28 |
| 最后更新 | 2026-02-28 |

---

## 1. 依赖概览

### 1.1 前端依赖 (package.json)

```json
{
  "dependencies": {
    "@ant-design/icons": "^5.3.x",
    "@tauri-apps/api": "^2.0.x",
    "@tauri-apps/plugin-dialog": "^2.0.x",
    "@tauri-apps/plugin-fs": "^2.0.x",
    "@tauri-apps/plugin-sql": "^2.0.x",
    "antd": "^5.15.x",
    "class-variance-authority": "^0.7.x",
    "clsx": "^2.1.x",
    "date-fns": "^3.3.x",
    "lodash-es": "^4.17.x",
    "nanoid": "^5.0.x",
    "react": "^18.3.x",
    "react-dom": "^18.3.x",
    "react-error-boundary": "^4.0.x",
    "tailwind-merge": "^2.2.x",
    "zustand": "^4.5.x"
  },
  "devDependencies": {
    "@tauri-apps/cli": "^2.0.x",
    "@types/lodash-es": "^4.17.x",
    "@types/react": "^18.3.x",
    "@types/react-dom": "^18.3.x",
    "@vitejs/plugin-react-swc": "^3.6.x",
    "autoprefixer": "^10.4.x",
    "eslint": "^8.57.x",
    "postcss": "^8.4.x",
    "prettier": "^3.2.x",
    "prettier-plugin-tailwindcss": "^0.5.x",
    "tailwindcss": "^3.4.x",
    "typescript": "^5.4.x",
    "vite": "^5.1.x",
    "vitest": "^1.3.x"
  }
}
```

### 1.2 后端依赖 (Cargo.toml)

```toml
[dependencies]
tauri = { version = "2.0", features = ["protocol-asset"] }
tauri-plugin-dialog = "2.0"
tauri-plugin-fs = "2.0"
tauri-plugin-sql = { version = "2.0", features = ["sqlite"] }
serde = { version = "1.0", features = ["derive"] }
serde_json = "1.0"
tokio = { version = "1.36", features = ["full"] }
reqwest = { version = "0.11", features = ["json", "stream"] }
rusqlite = { version = "0.31", features = ["bundled"] }
aes-gcm = "0.10"
pbkdf2 = "0.12"
sha2 = "0.10"
regex = "1.10"
chrono = { version = "0.4", features = ["serde"] }
uuid = { version = "1.7", features = ["v4", "serde"] }
thiserror = "1.0"
log = "0.4"
env_logger = "0.11"

[build-dependencies]
tauri-build = "2.0"
```

---

## 2. 核心依赖说明

### 2.1 Tauri 相关

| 包名 | 版本 | 用途 | 许可证 |
|------|------|------|--------|
| @tauri-apps/api | 2.0.x | Tauri 前端 API | MIT |
| @tauri-apps/plugin-dialog | 2.0.x | 原生对话框 | MIT |
| @tauri-apps/plugin-fs | 2.0.x | 文件系统操作 | MIT |
| @tauri-apps/plugin-sql | 2.0.x | 数据库操作 | MIT |
| tauri (Rust) | 2.0.x | Tauri 核心框架 | MIT |

**使用说明**:
```typescript
// 调用 Tauri 命令
import { invoke } from '@tauri-apps/api/core';
const result = await invoke('command_name', { args });

// 文件对话框
import { open, save } from '@tauri-apps/plugin-dialog';
const files = await open({ multiple: true, filters: [...] });

// 文件操作
import { readTextFile, writeTextFile } from '@tauri-apps/plugin-fs';
const content = await readTextFile(path);
```

### 2.2 React 生态

| 包名 | 版本 | 用途 | 许可证 |
|------|------|------|--------|
| react | 18.3.x | UI 框架 | MIT |
| react-dom | 18.3.x | DOM 渲染 | MIT |
| react-error-boundary | 4.0.x | 错误边界 | MIT |

**使用说明**:
```typescript
// 错误边界
import { ErrorBoundary } from 'react-error-boundary';

<ErrorBoundary
  FallbackComponent={ErrorFallback}
  onError={handleError}
>
  <App />
</ErrorBoundary>
```

### 2.3 UI 组件库

| 包名 | 版本 | 用途 | 许可证 |
|------|------|------|--------|
| antd | 5.15.x | UI 组件库 | MIT |
| @ant-design/icons | 5.3.x | 图标库 | MIT |

**使用说明**:
```typescript
import { Button, Table, Form, Input, Modal } from 'antd';
import { FileOutlined, SaveOutlined } from '@ant-design/icons';

// 按需导入，支持 Tree Shaking
<Button type="primary" icon={<SaveOutlined />}>保存</Button>
```

**主题定制**:
```typescript
import { ConfigProvider } from 'antd';

<ConfigProvider
  theme={{
    token: {
      colorPrimary: '#52C41A',  // 私域主色
    },
  }}
>
  <App />
</ConfigProvider>
```

### 2.4 状态管理

| 包名 | 版本 | 用途 | 许可证 |
|------|------|------|--------|
| zustand | 4.5.x | 状态管理 | MIT |

**使用说明**:
```typescript
import { create } from 'zustand';

interface Store {
  count: number;
  increment: () => void;
}

const useStore = create<Store>((set) => ({
  count: 0,
  increment: () => set((state) => ({ count: state.count + 1 })),
}));

// 在组件中使用
const count = useStore((state) => state.count);
const increment = useStore((state) => state.increment);
```

### 2.5 样式相关

| 包名 | 版本 | 用途 | 许可证 |
|------|------|------|--------|
| tailwindcss | 3.4.x | 原子化 CSS | MIT |
| class-variance-authority | 0.7.x | 变体样式管理 | Apache-2.0 |
| tailwind-merge | 2.2.x | 类名合并 | MIT |
| clsx | 2.1.x | 条件类名 | MIT |

**使用说明**:
```typescript
import { cva, type VariantProps } from 'class-variance-authority';
import { twMerge } from 'tailwind-merge';
import { clsx } from 'clsx';

// 工具函数
function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs));
}

// CVA 变体
const buttonVariants = cva('rounded font-medium', {
  variants: {
    variant: {
      primary: 'bg-primary text-white',
      secondary: 'bg-gray-100 text-gray-900',
    },
    size: {
      sm: 'px-3 py-1.5 text-sm',
      md: 'px-4 py-2 text-base',
    },
  },
});
```

### 2.6 工具库

| 包名 | 版本 | 用途 | 许可证 |
|------|------|------|--------|
| lodash-es | 4.17.x | 工具函数 | MIT |
| date-fns | 3.3.x | 日期处理 | MIT |
| nanoid | 5.0.x | ID 生成 | MIT |

**使用说明**:
```typescript
// lodash-es (按需导入)
import { debounce, throttle, cloneDeep } from 'lodash-es';

// date-fns
import { format, formatDistanceToNow } from 'date-fns';
import { zhCN } from 'date-fns/locale';

format(new Date(), 'yyyy年MM月dd日', { locale: zhCN });
formatDistanceToNow(date, { addSuffix: true, locale: zhCN });

// nanoid
import { nanoid } from 'nanoid';
const id = nanoid(); // "V1StGXR8_Z5jdHi6B-myT"
```

---

## 3. Rust 依赖说明

### 3.1 Web 请求

| 包名 | 版本 | 用途 |
|------|------|------|
| reqwest | 0.11.x | HTTP 客户端 |
| tokio | 1.36.x | 异步运行时 |

**使用说明**:
```rust
use reqwest::Client;

let client = Client::new();
let response = client
    .post("https://api.example.com/v1/chat")
    .json(&request_body)
    .send()
    .await?;
```

### 3.2 数据库

| 包名 | 版本 | 用途 |
|------|------|------|
| rusqlite | 0.31.x | SQLite 绑定 |
| tauri-plugin-sql | 2.0.x | Tauri SQL 插件 |

**使用说明**:
```rust
use rusqlite::Connection;

let conn = Connection::open("redink.db")?;
conn.execute(
    "INSERT INTO documents (id, title) VALUES (?1, ?2)",
    params![id, title],
)?;
```

### 3.3 加密

| 包名 | 版本 | 用途 |
|------|------|------|
| aes-gcm | 0.10.x | AES-GCM 加密 |
| pbkdf2 | 0.12.x | 密钥派生 |
| sha2 | 0.10.x | SHA 哈希 |

**使用说明**:
```rust
use aes_gcm::{Aes256Gcm, KeyInit, aead::Aead};
use pbkdf2::pbkdf2_hmac;
use sha2::Sha256;

// 密钥派生
let mut key = [0u8; 32];
pbkdf2_hmac::<Sha256>(password, salt, iterations, &mut key);

// 加密
let cipher = Aes256Gcm::new(&key.into());
let ciphertext = cipher.encrypt(&nonce.into(), plaintext)?;
```

### 3.4 序列化

| 包名 | 版本 | 用途 |
|------|------|------|
| serde | 1.0.x | 序列化框架 |
| serde_json | 1.0.x | JSON 序列化 |

**使用说明**:
```rust
use serde::{Deserialize, Serialize};

#[derive(Serialize, Deserialize)]
struct Document {
    id: String,
    title: String,
    content: Option<String>,
}

let json = serde_json::to_string(&doc)?;
let doc: Document = serde_json::from_str(&json)?;
```

### 3.5 其他工具

| 包名 | 版本 | 用途 |
|------|------|------|
| uuid | 1.7.x | UUID 生成 |
| chrono | 0.4.x | 日期时间 |
| regex | 1.10.x | 正则表达式 |
| thiserror | 1.0.x | 错误定义 |
| log | 0.4.x | 日志接口 |

---

## 4. 开发依赖说明

### 4.1 构建工具

| 包名 | 版本 | 用途 |
|------|------|------|
| vite | 5.1.x | 构建工具 |
| @vitejs/plugin-react-swc | 3.6.x | React 快速刷新 |
| typescript | 5.4.x | 类型检查 |

### 4.2 代码质量

| 包名 | 版本 | 用途 |
|------|------|------|
| eslint | 8.57.x | 代码检查 |
| prettier | 3.2.x | 代码格式化 |
| prettier-plugin-tailwindcss | 0.5.x | Tailwind 类名排序 |

### 4.3 测试工具

| 包名 | 版本 | 用途 |
|------|------|------|
| vitest | 1.3.x | 单元测试 |
| @testing-library/react | 14.x | React 测试 |

---

## 5. 许可证汇总

| 许可证 | 依赖数量 | 说明 |
|--------|----------|------|
| MIT | 35+ | 最宽松，可商用 |
| Apache-2.0 | 3 | 可商用，需保留声明 |
| BSD | 2 | 可商用 |

**所有依赖均为开源许可，允许商业使用。**

---

## 6. 版本更新策略

### 6.1 更新频率

| 类型 | 频率 | 说明 |
|------|------|------|
| 安全更新 | 立即 | 发现漏洞立即更新 |
| 小版本 (patch) | 每周 | 自动化检查更新 |
| 中版本 (minor) | 每月 | 评估后手动更新 |
| 大版本 (major) | 季度 | 充分测试后更新 |

### 6.2 更新命令

```bash
# 检查过期依赖
pnpm outdated

# 更新 patch 版本
pnpm update

# 更新指定包
pnpm update antd

# 检查安全漏洞
pnpm audit
```

### 6.3 锁定策略

- 使用 `pnpm-lock.yaml` 锁定精确版本
- CI/CD 环境使用 `--frozen-lockfile`
- 禁止直接修改 lock 文件

---

## 7. 依赖安全

### 7.1 安全扫描

```bash
# npm 审计
pnpm audit

# 修复已知漏洞
pnpm audit --fix
```

### 7.2 已知风险

截至文档编写时，所有依赖无已知高危漏洞。

---

*文档结束*
