# 交互设计文档

## 文档信息

| 项目 | 内容 |
|------|------|
| 文档版本 | V1.2 |
| 文档状态 | 已更新 |
| 创建日期 | 2026-02-28 |
| 最后更新 | 2026-02-28 |
| 更新内容 | 新增文档导入导出交互、知识库功能交互、优化AI助手交互 |

---

## 1. 交互设计原则

### 1.1 核心原则

| 原则 | 说明 | 具体要求 |
|------|------|----------|
| 环境感知 | 用户必须始终清楚当前所处环境 | 状态栏常驻显示、颜色区分明显 |
| 操作高效 | 常用功能一步直达 | 工具栏快捷访问、快捷键支持 |
| 反馈及时 | 每个操作都有明确反馈 | 加载状态、成功/失败提示 |
| 容错友好 | 允许撤销、防止误操作 | 危险操作二次确认、自动保存 |
| 学习成本低 | 符合用户心智模型 | 遵循通用交互规范 |

### 1.2 交互层级

```
┌─────────────────────────────────────────────────────────────────────┐
│                          交互层级设计                                │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  第一层级: 全局导航                                                  │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │  [环境状态]  [主导航]  [全局搜索]  [设置]                    │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│  第二层级: 功能区域                                                  │
│  ┌──────────┬──────────────────────────────────┬──────────────┐   │
│  │ 侧边导航  │          主工作区                │   辅助面板   │   │
│  │          │                                  │              │   │
│  │ 文档列表  │         编辑/预览                │   AI助手     │   │
│  │ 模板库   │                                  │   属性面板   │   │
│  │ 历史记录  │                                  │              │   │
│  └──────────┴──────────────────────────────────┴──────────────┘   │
│                                                                     │
│  第三层级: 局部交互                                                  │
│  • 右键菜单                                                         │
│  • 弹出面板                                                         │
│  • 模态对话框                                                       │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 2. 导航设计

### 2.1 顶部状态栏

```
┌─────────────────────────────────────────────────────────────────────┐
│                        顶部状态栏交互                                │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │ [🛡️ 私域环境 - 数据本地处理]              [切换环境] [⚙️]   │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│  交互行为:                                                          │
│                                                                     │
│  1. 环境标识区 (左侧)                                               │
│     • 显示当前环境名称和图标                                        │
│     • 悬停: 显示环境详细说明 tooltip                                │
│     • 点击: 无操作 (仅展示)                                         │
│                                                                     │
│  2. 环境切换按钮                                                    │
│     • 显示目标环境图标和名称                                        │
│     • 点击: 触发环境切换流程                                        │
│     • 私域→公网: 弹出安全确认对话框                                 │
│     • 公网→私域: 直接切换，Toast提示                                │
│                                                                     │
│  3. 设置按钮                                                        │
│     • 点击: 打开设置面板/页面                                       │
│     • 悬停: 显示 "设置" tooltip                                     │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 2.2 活动栏

```
┌─────────────────────────────────────────────────────────────────────┐
│                          活动栏交互                                  │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  ┌──────┐                                                          │
│  │  📄  │ ◄─ 我的文档 (默认选中)                                   │
│  │  📋  │ ◄─ 模板库                                                │
│  │  🕐  │ ◄─ 最近使用                                              │
│  │  ⭐  │ ◄─ 收藏                                                  │
│  │  📦  │ ◄─ 素材库                                                │
│  │  📚  │ ◄─ 知识库                                                │
│  │  📊  │ ◄─ 图表                                                  │
│  │ ──── │                                                          │
│  │  ⚙️  │ ◄─ 设置 (底部固定)                                       │
│  └──────┘                                                          │
│                                                                     │
│  交互行为:                                                          │
│                                                                     │
│  1. 图标点击                                                        │
│     • 点击: 切换侧边栏显示对应内容                                  │
│     • 选中状态: 左侧显示2px主题色指示条，背景高亮                   │
│     • 再次点击选中项: 折叠/展开侧边栏                               │
│                                                                     │
│  2. 悬停交互                                                        │
│     • 悬停: 显示浅灰色背景                                          │
│     • Tooltip: 延迟500ms显示功能名称                                │
│     • 位置: 图标右侧                                                │
│                                                                     │
│  3. 快捷键                                                          │
│     • Ctrl+Shift+E: 聚焦活动栏                                      │
│     • 上/下箭头: 在活动栏图标间导航                                 │
│     • Enter: 激活当前图标                                           │
│                                                                     │
│  4. 环境联动                                                        │
│     • 选中项指示条颜色跟随当前环境主题色                            │
│     • 私域环境: #52C41A (绿色)                                      │
│     • 公网环境: #1890FF (蓝色)                                      │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 2.3 侧边导航栏

```
┌─────────────────────────────────────────────────────────────────────┐
│                        侧边导航交互                                  │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  ┌──────────────────┐                                              │
│  │  📄 我的文档      │ ◄─ 默认选中                                  │
│  │  ────────────────│                                              │
│  │  📋 模板库        │                                              │
│  │  🕐 最近使用      │                                              │
│  │  ⭐ 收藏          │                                              │
│  │  ────────────────│                                              │
│  │  🗑️ 回收站       │                                              │
│  │                  │                                              │
│  │ ─────────────────│                                              │
│  │  [<<] 折叠       │                                              │
│  └──────────────────┘                                              │
│                                                                     │
│  交互行为:                                                          │
│                                                                     │
│  1. 导航项                                                          │
│     • 点击: 切换到对应视图                                          │
│     • 悬停: 高亮显示                                                │
│     • 选中: 左侧显示指示条，背景高亮                                │
│                                                                     │
│  2. 折叠按钮                                                        │
│     • 点击: 折叠/展开侧边栏                                         │
│     • 折叠后: 仅显示图标，悬停显示tooltip                           │
│                                                                     │
│  3. 快捷键                                                          │
│     • Ctrl+1: 我的文档                                              │
│     • Ctrl+2: 模板库                                                │
│     • Ctrl+B: 折叠/展开侧边栏                                       │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 2.4 素材库交互

```
┌─────────────────────────────────────────────────────────────────────┐
│                        素材库交互设计                                │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  ┌──────────────────────────────────────────────────────────────┐  │
│  │ 常用短语 │ 段落模板 │ 图片素材 │ 表格模板 │ 收藏            │  │
│  │ ════════                                                     │  │
│  └──────────────────────────────────────────────────────────────┘  │
│                                                                     │
│  交互行为:                                                          │
│                                                                     │
│  1. Tab切换                                                         │
│     • 点击Tab: 切换素材类型                                         │
│     • 当前Tab: 底部显示指示条                                       │
│     • 快捷键: Ctrl+1~5 切换Tab                                      │
│                                                                     │
│  2. 素材列表                                                        │
│     • 单击素材: 选中并预览                                          │
│     • 双击素材: 直接插入到当前光标位置                              │
│     • 右键菜单: 编辑、删除、收藏、复制                              │
│                                                                     │
│  3. 快速插入                                                        │
│     • 点击[插入]按钮: 插入到当前编辑器光标位置                      │
│     • 拖拽素材: 拖拽到编辑器指定位置插入                            │
│     • 插入后: Toast提示"已插入"                                     │
│                                                                     │
│  4. 搜索交互                                                        │
│     • 输入关键词: 实时过滤素材列表                                  │
│     • 搜索范围: 当前Tab内搜索                                       │
│     • 清空搜索: 点击×或按Esc                                        │
│                                                                     │
│  5. 新建素材                                                        │
│     • 点击[+新建]: 弹出新建对话框                                   │
│     • 短语: 输入内容、选择分类                                      │
│     • 图片: 选择文件上传、设置名称和分类                            │
│     • 保存后: 自动添加到列表并选中                                  │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 2.5 知识库交互

```
┌─────────────────────────────────────────────────────────────────────┐
│                        知识库交互设计                                │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  知识库界面布局:                                                    │
│  ┌────────────────────────────────────────────────────────────┐    │
│  │  知识库                                    [🔍 搜索] [+ 添加]│    │
│  │  ────────────────────────────────────────────────────────  │    │
│  │                                                             │    │
│  │  我的知识库  共享知识库                                     │    │
│  │  ══════════                                                 │    │
│  │                                                             │    │
│  │  ┌───────────────────────────────────────────────────────┐│    │
│  │  │ 📚 公文写作规范                          12个文档     ││    │
│  │  │    包含党政机关公文格式标准、常用表述等                ││    │
│  │  │    更新于 2天前                    [问答] [管理] [···]││    │
│  │  ├───────────────────────────────────────────────────────┤│    │
│  │  │ 📚 政策法规库                            28个文档     ││    │
│  │  │    包含相关政策文件、法规条例等                        ││    │
│  │  │    更新于 1周前                    [问答] [管理] [···]││    │
│  │  ├───────────────────────────────────────────────────────┤│    │
│  │  │ 📚 历史公文参考                          45个文档     ││    │
│  │  │    包含历年优秀公文范例                                ││    │
│  │  │    更新于 3天前                    [问答] [管理] [···]││    │
│  │  └───────────────────────────────────────────────────────┘│    │
│  │                                                             │    │
│  │                                        [+ 新建知识库]       │    │
│  └────────────────────────────────────────────────────────────┘    │
│                                                                     │
│  交互行为:                                                          │
│                                                                     │
│  1. 知识库列表                                                      │
│     • 单击: 展开显示知识库详情                                      │
│     • [问答]: 打开知识库问答面板                                    │
│     • [管理]: 进入知识库管理页面                                    │
│     • [···]: 更多操作(重命名、删除、导出)                           │
│                                                                     │
│  2. 搜索交互                                                        │
│     • 输入关键词: 搜索知识库名称和内容                              │
│     • 支持全文搜索和语义搜索                                        │
│                                                                     │
│  3. 添加文档到知识库                                                │
│     • 拖拽文档到知识库项                                            │
│     • 点击[+ 添加] 选择文档                                         │
│     • 从文档列表右键菜单添加                                        │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 2.6 知识库管理交互

```
┌─────────────────────────────────────────────────────────────────────┐
│                      知识库管理交互流程                              │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  新建知识库:                                                        │
│  ┌────────────────────────────────────────┐                        │
│  │  新建知识库                             │                        │
│  │  ──────────────────────────────────── │                        │
│  │                                        │                        │
│  │  知识库名称:                           │                        │
│  │  [公文写作规范                    ]    │                        │
│  │                                        │                        │
│  │  描述 (可选):                          │                        │
│  │  [包含党政机关公文格式标准...    ]    │                        │
│  │                                        │                        │
│  │  向量模型:                             │                        │
│  │  [bge-small-zh (本地)         ▼]       │ ◄─ 私域环境默认本地    │
│  │                                        │                        │
│  │  存储位置:                             │                        │
│  │  (•) 本地存储 (数据不离开本机)         │                        │
│  │  ( ) 云端同步 (仅公网环境可用)         │                        │
│  │                                        │                        │
│  │              [取消]  [创建]            │                        │
│  └────────────────────────────────────────┘                        │
│                                                                     │
│  添加文档到知识库:                                                  │
│  ┌────────────────────────────────────────┐                        │
│  │  添加文档                               │                        │
│  │  ──────────────────────────────────── │                        │
│  │                                        │                        │
│  │  选择添加方式:                         │                        │
│  │                                        │                        │
│  │  ┌────────────┐ ┌────────────┐        │                        │
│  │  │ 📄 从应用  │ │ 📁 从文件  │        │                        │
│  │  │  选择文档  │ │  系统导入  │        │                        │
│  │  └────────────┘ └────────────┘        │                        │
│  │                                        │                        │
│  │  支持格式: DOCX、PDF、TXT、MD          │                        │
│  │                                        │                        │
│  │  处理选项:                             │                        │
│  │  ☑ 自动分块 (按段落/章节)              │                        │
│  │  ☑ 提取标题作为元数据                  │                        │
│  │  ☐ 保留原始文件副本                    │                        │
│  │                                        │                        │
│  └────────────────────────────────────────┘                        │
│                                                                     │
│  文档入库进度:                                                      │
│  ┌────────────────────────────────────────┐                        │
│  │  正在处理文档...                        │                        │
│  │  ━━━━━━━━━━━━━━━━━━━━━━━░░░ 85%       │                        │
│  │                                        │                        │
│  │  当前: 工作报告.docx                   │                        │
│  │                                        │                        │
│  │  · 解析文档内容 ✓                      │                        │
│  │  · 文本分块处理 ✓                      │                        │
│  │  · 生成向量嵌入 ⟳                      │ ◄─ 调用本地向量模型    │
│  │  · 存储到向量库 ○                      │                        │
│  │                                        │                        │
│  │  已处理: 3/5 个文档                    │                        │
│  └────────────────────────────────────────┘                        │
│                                                                     │
│  知识库详情管理:                                                    │
│  ┌────────────────────────────────────────────────────────────┐   │
│  │  公文写作规范                                    [编辑] [删除]│   │
│  │  ────────────────────────────────────────────────────────  │   │
│  │                                                             │   │
│  │  文档列表 (12)                             [🔍] [+ 添加]    │   │
│  │  ┌─────────────────────────────────────────────────────┐  │   │
│  │  │ ☐ │ 文档名称              │ 大小   │ 添加时间      │  │   │
│  │  ├───┼───────────────────────┼────────┼───────────────┤  │   │
│  │  │ ☐ │ 党政机关公文格式.pdf  │ 2.3MB  │ 2026-02-25    │  │   │
│  │  │ ☐ │ 公文写作要领.docx     │ 156KB  │ 2026-02-26    │  │   │
│  │  │ ☐ │ 常用表述汇编.docx     │ 89KB   │ 2026-02-27    │  │   │
│  │  │ ☐ │ 标点符号规范.pdf      │ 1.1MB  │ 2026-02-27    │  │   │
│  │  └─────────────────────────────────────────────────────┘  │   │
│  │                                                             │   │
│  │  批量操作: [删除选中] [重新索引]                            │   │
│  │                                                             │   │
│  │  知识库统计:                                                │   │
│  │  · 文档数: 12    · 文本块: 458    · 向量维度: 512          │   │
│  │  · 存储大小: 45MB · 最后更新: 2026-02-28 14:30             │   │
│  └────────────────────────────────────────────────────────────┘   │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 2.7 知识库问答交互

```
┌─────────────────────────────────────────────────────────────────────┐
│                      知识库问答交互流程                              │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  知识库问答面板 (集成在AI助手中):                                   │
│  ┌──────────────────────────────────────┐                          │
│  │  AI 助手                    [−] [×]  │                          │
│  ├──────────────────────────────────────┤                          │
│  │  ┌──────┬──────┬──────┬──────┐      │                          │
│  │  │ 生成 │ 审核 │ 改写 │▓问答▓│      │ ◄─ 新增"问答"标签页     │
│  │  └──────┴──────┴──────┴──────┘      │                          │
│  ├──────────────────────────────────────┤                          │
│  │                                      │                          │
│  │  选择知识库:                         │                          │
│  │  ┌────────────────────────────────┐ │                          │
│  │  │ ☑ 公文写作规范                  │ │                          │
│  │  │ ☑ 政策法规库                    │ │                          │
│  │  │ ☐ 历史公文参考                  │ │ ◄─ 可多选知识库          │
│  │  └────────────────────────────────┘ │                          │
│  │                                      │                          │
│  │  对话历史:                           │                          │
│  │  ┌────────────────────────────────┐ │                          │
│  │  │ 🧑 公文标题的字号要求是什么？  │ │                          │
│  │  │                                │ │                          │
│  │  │ 🤖 根据《党政机关公文格式》    │ │                          │
│  │  │    (GB/T 9704-2012)，公文      │ │                          │
│  │  │    标题应使用二号小标宋体字，  │ │                          │
│  │  │    字号为22磅。                │ │                          │
│  │  │                                │ │                          │
│  │  │    📎 来源: 党政机关公文格式.pdf│ │ ◄─ 显示引用来源          │
│  │  │       第3.2.1节 标题           │ │                          │
│  │  │                        [查看原文]│ │                          │
│  │  └────────────────────────────────┘ │                          │
│  │                                      │                          │
│  ├──────────────────────────────────────┤                          │
│  │  ┌────────────────────────┐ [发送] │                          │
│  │  │ 请输入您的问题...       │        │                          │
│  │  └────────────────────────┘        │                          │
│  ├──────────────────────────────────────┤                          │
│  │  🛡️ 私域环境 · 本地向量检索         │ ◄─ 环境状态提示          │
│  └──────────────────────────────────────┘                          │
│                                                                     │
│  交互行为:                                                          │
│                                                                     │
│  1. 知识库选择                                                      │
│     • 勾选知识库: 选择要查询的知识库范围                            │
│     • 支持多选，同时检索多个知识库                                  │
│     • 默认选中最近使用的知识库                                      │
│                                                                     │
│  2. 问答流程                                                        │
│     • 用户输入问题                                                  │
│     • 系统在本地向量库中检索相关内容                                │
│     • AI基于检索结果生成回答 (RAG)                                  │
│     • 显示回答并标注引用来源                                        │
│                                                                     │
│  3. 引用来源                                                        │
│     • 每个回答显示引用的文档来源                                    │
│     • 点击[查看原文]: 打开源文档并定位到相关段落                    │
│     • 支持引用多个来源并显示相关度                                  │
│                                                                     │
│  4. 追问交互                                                        │
│     • 支持基于上下文的连续追问                                      │
│     • 可点击引用内容快速追问                                        │
│     • 支持"引用到文档": 将回答插入当前编辑文档                     │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 3. 公文编辑交互

### 3.1 编辑器布局

```
┌─────────────────────────────────────────────────────────────────────┐
│                        编辑器界面布局                                │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │  工具栏                                                      │   │
│  │  [新建▼][打开][保存] │ [撤销][重做] │ [格式▼] │ [AI▼][导出▼]│   │
│  └─────────────────────────────────────────────────────────────┘   │
│  ┌───────────────────────────────────────────┬─────────────────┐   │
│  │                                           │                 │   │
│  │                                           │   AI 助手       │   │
│  │              编辑区域                      │                 │   │
│  │                                           │   [生成]        │   │
│  │         (富文本编辑器)                    │   [审核]        │   │
│  │                                           │   [改写]        │   │
│  │                                           │   [对话]        │   │
│  │                                           │                 │   │
│  │                                           │   ───────────   │   │
│  │                                           │                 │   │
│  │                                           │   对话区域      │   │
│  │                                           │                 │   │
│  └───────────────────────────────────────────┴─────────────────┘   │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │  状态栏: 字数: 1,234 │ 已保存 │ 第3页/共5页                  │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 3.2 工具栏交互

| 功能 | 触发方式 | 交互行为 |
|------|----------|----------|
| 新建 | 点击下拉 | 显示文档类型选择菜单 |
| 打开/导入 | 点击下拉 | 显示导入选项：打开本地文档、导入DOCX、导入PDF |
| 保存 | 点击/Ctrl+S | 保存当前文档，显示保存成功提示 |
| 撤销/重做 | 点击/Ctrl+Z/Y | 撤销/重做操作，按钮禁用时变灰 |
| 格式 | 点击下拉 | 显示格式设置菜单 |
| AI | 点击下拉 | 显示AI功能菜单：生成、审核、改写、知识库问答 |
| 导出 | 点击下拉 | 显示导出格式选择：DOCX、PDF、Markdown、OFD |

### 3.3 文本选择交互

```
┌─────────────────────────────────────────────────────────────────────┐
│                        文本选择交互                                  │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  选中文本后显示浮动工具栏:                                          │
│                                                                     │
│       "这是选中的一段文本内容"                                      │
│       ━━━━━━━━━━━━━━━━━━━━━━━                                      │
│       ┌────────────────────────────────────┐                       │
│       │ [B] [I] [U] │ [🤖改写] [📋复制]    │                       │
│       └────────────────────────────────────┘                       │
│                                                                     │
│  交互行为:                                                          │
│                                                                     │
│  1. 选中文本后                                                      │
│     • 延迟200ms显示浮动工具栏                                       │
│     • 工具栏显示在选中文本上方                                      │
│                                                                     │
│  2. 浮动工具栏                                                      │
│     • B/I/U: 加粗/斜体/下划线                                       │
│     • 改写: 调用AI改写选中内容                                      │
│     • 复制: 复制选中文本                                            │
│                                                                     │
│  3. 点击其他区域                                                    │
│     • 工具栏消失                                                    │
│     • 取消选中状态                                                  │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 3.4 右键菜单

```
┌─────────────────────────────────────────────────────────────────────┐
│                        右键上下文菜单                                │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  编辑区右键菜单:                                                    │
│  ┌────────────────────┐                                            │
│  │ 剪切          Ctrl+X│                                           │
│  │ 复制          Ctrl+C│                                           │
│  │ 粘贴          Ctrl+V│                                           │
│  │ ──────────────────│                                             │
│  │ AI 改写        →   │──┐                                         │
│  │ AI 续写            │  │  ┌──────────────┐                       │
│  │ ──────────────────│  └──│ 润色         │                       │
│  │ 插入图表       →   │     │ 精简         │                       │
│  │ ──────────────────│     │ 扩展         │                       │
│  │ 段落格式       →   │     │ 正式化       │                       │
│  └────────────────────┘     └──────────────┘                       │
│                                                                     │
│  文档列表右键菜单:                                                  │
│  ┌────────────────────┐                                            │
│  │ 打开                │                                           │
│  │ 重命名              │                                           │
│  │ 复制                │                                           │
│  │ ──────────────────│                                             │
│  │ 导出           →   │                                            │
│  │ ──────────────────│                                             │
│  │ 移至回收站          │                                           │
│  └────────────────────┘                                            │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 3.5 文档导入交互

```
┌─────────────────────────────────────────────────────────────────────┐
│                        文档导入交互流程                              │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  导入入口:                                                          │
│  • 工具栏 [打开/导入▼] 按钮                                         │
│  • 快捷键 Ctrl+O                                                    │
│  • 拖拽文件到编辑区                                                 │
│                                                                     │
│  导入选项菜单:                                                      │
│  ┌────────────────────────┐                                        │
│  │ 📄 打开本地文档         │ ◄─ 打开应用内保存的文档                │
│  │ ──────────────────────│                                         │
│  │ 📥 导入 DOCX 文件       │ ◄─ 导入Word文档                        │
│  │ 📥 导入 PDF 文件        │ ◄─ 导入PDF文档(OCR识别)                │
│  │ 📥 导入 Markdown 文件   │ ◄─ 导入MD文件                          │
│  │ ──────────────────────│                                         │
│  │ 📁 批量导入...          │ ◄─ 选择多个文件批量导入                │
│  └────────────────────────┘                                        │
│                                                                     │
│  DOCX导入流程:                                                      │
│  ┌────────────────────────────────────────┐                        │
│  │  导入 Word 文档                        │                        │
│  │  ──────────────────────────────────── │                        │
│  │                                        │                        │
│  │  已选择: 工作报告.docx                 │                        │
│  │                                        │                        │
│  │  导入选项:                             │                        │
│  │  ☑ 保留原有格式                        │                        │
│  │  ☑ 导入图片和表格                      │                        │
│  │  ☐ 自动识别公文类型                    │                        │
│  │  ☐ 导入后自动审核                      │                        │
│  │                                        │                        │
│  │  高级选项:                             │                        │
│  │  ☐ 同时加入知识库                      │ ◄─ 可选添加到知识库    │
│  │                                        │                        │
│  │              [取消]  [开始导入]        │                        │
│  └────────────────────────────────────────┘                        │
│                                                                     │
│  PDF导入流程:                                                       │
│  ┌────────────────────────────────────────┐                        │
│  │  导入 PDF 文档                         │                        │
│  │  ──────────────────────────────────── │                        │
│  │                                        │                        │
│  │  已选择: 政策文件.pdf                  │                        │
│  │                                        │                        │
│  │  识别模式:                             │                        │
│  │  (•) 文本提取 (适用于可选择文本的PDF)  │                        │
│  │  ( ) OCR识别 (适用于扫描件)            │                        │
│  │                                        │                        │
│  │  页面范围:                             │                        │
│  │  (•) 全部页面                          │                        │
│  │  ( ) 指定页面: [1-5, 10]               │                        │
│  │                                        │                        │
│  │              [取消]  [开始导入]        │                        │
│  └────────────────────────────────────────┘                        │
│                                                                     │
│  导入进度:                                                          │
│  ┌────────────────────────────────────────┐                        │
│  │  📥 正在导入...                        │                        │
│  │  ━━━━━━━━━━━━━━━━━━━━━░░░░ 78%        │                        │
│  │                                        │                        │
│  │  · 解析文档结构 ✓                      │                        │
│  │  · 提取文本内容 ✓                      │                        │
│  │  · 转换格式样式 ⟳                      │                        │
│  │  · 导入图片附件 ○                      │                        │
│  └────────────────────────────────────────┘                        │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 3.6 文档导出交互

```
┌─────────────────────────────────────────────────────────────────────┐
│                        文档导出交互流程                              │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  导出入口:                                                          │
│  • 工具栏 [导出▼] 按钮                                              │
│  • 快捷键 Ctrl+Shift+E                                              │
│  • 文件菜单 → 导出                                                  │
│                                                                     │
│  导出格式选择:                                                      │
│  ┌────────────────────────────────────────────────────────────┐    │
│  │  导出文档                                                   │    │
│  │  ────────────────────────────────────────────────────────  │    │
│  │                                                             │    │
│  │  选择导出格式:                                              │    │
│  │                                                             │    │
│  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐          │    │
│  │  │    DOCX     │ │     PDF     │ │   Markdown  │          │    │
│  │  │ ▓▓▓▓▓▓▓▓▓▓▓ │ │             │ │             │          │    │
│  │  │ Word 文档   │ │  便携文档   │ │  纯文本格式 │          │    │
│  │  │   已选中    │ │             │ │             │          │    │
│  │  └─────────────┘ └─────────────┘ └─────────────┘          │    │
│  │                                                             │    │
│  │  ┌─────────────┐ ┌─────────────┐                          │    │
│  │  │     OFD     │ │    HTML     │                          │    │
│  │  │             │ │             │                          │    │
│  │  │ 国产版式文档│ │   网页格式  │                          │    │
│  │  └─────────────┘ └─────────────┘                          │    │
│  │                                                             │    │
│  └────────────────────────────────────────────────────────────┘    │
│                                                                     │
│  DOCX导出选项:                                                      │
│  ┌────────────────────────────────────────┐                        │
│  │  Word 文档导出选项                      │                        │
│  │  ──────────────────────────────────── │                        │
│  │                                        │                        │
│  │  格式规范:                             │                        │
│  │  ☑ 使用党政机关公文格式标准            │                        │
│  │  ☑ 嵌入字体 (确保显示一致)             │                        │
│  │                                        │                        │
│  │  内容选项:                             │                        │
│  │  ☑ 包含图表                            │                        │
│  │  ☐ 包含修订历史                        │                        │
│  │  ☐ 包含批注                            │                        │
│  │                                        │                        │
│  │  文件名: [工作报告_20260228        ]   │                        │
│  │  保存到: [C:\Documents\公文\    ] [浏览]│                       │
│  │                                        │                        │
│  │              [取消]  [导出]            │                        │
│  └────────────────────────────────────────┘                        │
│                                                                     │
│  PDF导出选项:                                                       │
│  ┌────────────────────────────────────────┐                        │
│  │  PDF 文档导出选项                       │                        │
│  │  ──────────────────────────────────── │                        │
│  │                                        │                        │
│  │  页面设置:                             │                        │
│  │  纸张: [A4 (210×297mm)        ▼]       │                        │
│  │  方向: (•) 纵向  ( ) 横向              │                        │
│  │                                        │                        │
│  │  PDF选项:                              │                        │
│  │  ☑ 生成书签目录                        │                        │
│  │  ☑ 可选择文本 (非图片格式)             │                        │
│  │  ☐ 添加水印                            │                        │
│  │  ☐ 加密保护 (需设置密码)               │                        │
│  │                                        │                        │
│  │              [取消]  [导出]            │                        │
│  └────────────────────────────────────────┘                        │
│                                                                     │
│  批量导出:                                                          │
│  ┌────────────────────────────────────────┐                        │
│  │  批量导出                               │                        │
│  │  ──────────────────────────────────── │                        │
│  │                                        │                        │
│  │  已选择 5 个文档                       │                        │
│  │  ┌──────────────────────────────────┐ │                        │
│  │  │ ☑ 会议通知.rdoc                   │ │                        │
│  │  │ ☑ 工作报告.rdoc                   │ │                        │
│  │  │ ☑ 项目请示.rdoc                   │ │                        │
│  │  │ ☑ 批复文件.rdoc                   │ │                        │
│  │  │ ☑ 会议纪要.rdoc                   │ │                        │
│  │  └──────────────────────────────────┘ │                        │
│  │                                        │                        │
│  │  导出格式: [DOCX         ▼]            │                        │
│  │  ☑ 每个文档单独文件                    │                        │
│  │  ☐ 合并为一个文件                      │                        │
│  │                                        │                        │
│  │              [取消]  [批量导出]        │                        │
│  └────────────────────────────────────────┘                        │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 4. AI助手交互

### 4.1 AI面板布局

```
┌─────────────────────────────────────────────────────────────────────┐
│                        AI助手面板                                    │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  ┌──────────────────────────────────────┐                          │
│  │  AI 助手                    [−] [×]  │  ◄─ 可最小化/关闭        │
│  ├──────────────────────────────────────┤                          │
│  │  ┌──────┬──────┬──────┬──────┬────┐ │                          │
│  │  │ 生成 │ 审核 │ 改写 │ 问答 │对话│ │  ◄─ 功能标签页           │
│  │  └──────┴──────┴──────┴──────┴────┘ │                          │
│  ├──────────────────────────────────────┤                          │
│  │                                      │                          │
│  │  ┌────────────────────────────────┐ │                          │
│  │  │                                │ │                          │
│  │  │      内容展示区域              │ │  ◄─ 滚动区域             │
│  │  │                                │ │                          │
│  │  │  AI响应内容...                 │ │                          │
│  │  │  █ (光标闪烁，流式输出)       │ │                          │
│  │  │                                │ │                          │
│  │  └────────────────────────────────┘ │                          │
│  │                                      │                          │
│  ├──────────────────────────────────────┤                          │
│  │  ┌────────────────────────┐ [发送] │  ◄─ 输入区域             │
│  │  │ 请输入您的要求...       │        │                          │
│  │  └────────────────────────┘        │                          │
│  ├──────────────────────────────────────┤                          │
│  │  当前: Ollama (qwen:7b)    [设置]   │  ◄─ AI状态栏             │
│  └──────────────────────────────────────┘                          │
│                                                                     │
│  功能标签页说明:                                                    │
│  • 生成: 根据要点生成公文内容                                       │
│  • 审核: 检查格式规范和内容质量                                     │
│  • 改写: 润色、精简、扩展选中内容                                   │
│  • 问答: 基于知识库的智能问答 (RAG)                                 │
│  • 对话: 自由对话，获取写作建议                                     │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 4.2 生成功能交互流程

```
┌─────────────────────────────────────────────────────────────────────┐
│                      内容生成交互流程                                │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  步骤1: 选择文档类型                                                │
│  ┌────────────────────────────────────┐                            │
│  │  请选择要生成的公文类型:           │                            │
│  │                                    │                            │
│  │  [通知] [报告] [请示] [批复]       │                            │
│  │  [函]   [会议纪要] [其他]          │                            │
│  └────────────────────────────────────┘                            │
│                    ↓                                                │
│  步骤2: 输入关键信息                                                │
│  ┌────────────────────────────────────┐                            │
│  │  请输入公文要点:                   │                            │
│  │  ┌──────────────────────────────┐ │                            │
│  │  │ • 召开年度总结会议            │ │                            │
│  │  │ • 时间: 3月15日上午9点        │ │                            │
│  │  │ • 地点: 会议室A               │ │                            │
│  │  │ + 添加更多要点                │ │                            │
│  │  └──────────────────────────────┘ │                            │
│  │                          [生成]   │                            │
│  └────────────────────────────────────┘                            │
│                    ↓                                                │
│  步骤3: 显示生成结果                                                │
│  ┌────────────────────────────────────┐                            │
│  │  ✨ 正在生成...                    │                            │
│  │  ━━━━━━━━━━━━━━━━━░░░░░ 65%       │  ◄─ 进度条                 │
│  │                                    │                            │
│  │  关于召开年度总结会议的通知        │  ◄─ 流式输出显示           │
│  │                                    │                            │
│  │  各部门、各单位：                  │                            │
│  │  为总结过去一年的工作成果...█     │                            │
│  └────────────────────────────────────┘                            │
│                    ↓                                                │
│  步骤4: 操作生成结果                                                │
│  ┌────────────────────────────────────┐                            │
│  │  [插入到文档] [复制] [重新生成]    │                            │
│  └────────────────────────────────────┘                            │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 4.3 审核功能交互流程

```
┌─────────────────────────────────────────────────────────────────────┐
│                      内容审核交互流程                                │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  步骤1: 发起审核                                                    │
│  ┌────────────────────────────────────┐                            │
│  │  选择审核类型:                     │                            │
│  │  ☑ 格式审核  ☑ 内容审核  ☑ 语言审核│                            │
│  │                                    │                            │
│  │  [开始审核当前文档]                │                            │
│  └────────────────────────────────────┘                            │
│                    ↓                                                │
│  步骤2: 审核进行中                                                  │
│  ┌────────────────────────────────────┐                            │
│  │  🔍 正在审核...                    │                            │
│  │  ━━━━━━━━━━━━━━━━━━━━━━━━━        │                            │
│  └────────────────────────────────────┘                            │
│                    ↓                                                │
│  步骤3: 显示审核结果                                                │
│  ┌────────────────────────────────────┐                            │
│  │  审核结果: 75分                    │                            │
│  │  ┌──────────────────────────────┐ │                            │
│  │  │ 🔴 高优先级 (2)               │ │                            │
│  │  │ ├─ 标题字号不符合规范        │ │                            │
│  │  │ └─ 缺少文号                  │ │                            │
│  │  │                              │ │                            │
│  │  │ 🟡 中优先级 (3)               │ │                            │
│  │  │ ├─ 第3段存在口语化表达       │ │  ◄─ 点击可定位到文档       │
│  │  │ ├─ 落款日期格式不规范        │ │                            │
│  │  │ └─ 建议增加附件说明          │ │                            │
│  │  │                              │ │                            │
│  │  │ 🟢 低优先级 (1)               │ │                            │
│  │  │ └─ 部分段落可进一步精简      │ │                            │
│  │  └──────────────────────────────┘ │                            │
│  │                                    │                            │
│  │  [一键修复可自动修复项] [导出报告] │                            │
│  └────────────────────────────────────┘                            │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 5. 环境切换交互

### 5.1 切换流程

```
┌─────────────────────────────────────────────────────────────────────┐
│                      环境切换交互流程                                │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  场景A: 公网 → 私域 (无警告)                                        │
│  ────────────────────────────────────────                          │
│  1. 用户点击 [切换到私域 🛡️]                                        │
│  2. 界面颜色平滑过渡 (蓝→绿, 300ms)                                │
│  3. 状态栏更新为 "私域环境 - 数据本地处理"                          │
│  4. 显示Toast: "已切换到私域环境"                                   │
│  5. AI服务切换到本地Ollama                                          │
│                                                                     │
│  场景B: 私域 → 公网 (需确认)                                        │
│  ────────────────────────────────────────                          │
│  1. 用户点击 [切换到公网 ☁️]                                        │
│  2. 弹出安全确认对话框:                                             │
│     ┌────────────────────────────────────────┐                     │
│     │  ⚠️ 切换到公网环境                      │                     │
│     │                                        │                     │
│     │  您正在从私域环境切换到公网环境，       │                     │
│     │  请注意:                               │                     │
│     │                                        │                     │
│     │  • 公网环境下，输入内容将发送至云端AI   │                     │
│     │  • 请确保文档不包含敏感信息            │                     │
│     │                                        │                     │
│     │  ☐ 不再提示 (本次会话)                 │                     │
│     │                                        │                     │
│     │        [取消]  [我已了解，继续切换]    │                     │
│     └────────────────────────────────────────┘                     │
│  3. 用户确认后执行切换                                              │
│  4. 界面颜色平滑过渡 (绿→蓝, 300ms)                                │
│  5. 状态栏更新为 "公网环境"                                         │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 5.2 视觉切换效果

```
┌─────────────────────────────────────────────────────────────────────┐
│                      视觉切换动效                                    │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  切换前 (私域)                切换中                切换后 (公网)    │
│  ┌──────────────┐          ┌──────────────┐      ┌──────────────┐  │
│  │▓▓▓▓▓▓▓▓▓▓▓▓▓▓│          │▓▓▓▓▓▓▓░░░░░░░│      │░░░░░░░░░░░░░░│  │
│  │  #52C41A     │  ──────> │   渐变过渡   │ ───> │  #1890FF     │  │
│  │  私域环境    │   300ms  │              │      │  公网环境    │  │
│  └──────────────┘          └──────────────┘      └──────────────┘  │
│                                                                     │
│  变化元素:                                                          │
│  1. 顶部状态栏背景色                                                │
│  2. 环境图标 (盾牌 ↔ 云朵)                                         │
│  3. 环境文字标签                                                    │
│  4. 切换按钮文字和图标                                              │
│  5. 编辑区边框强调色                                                │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 6. 图表编辑交互

### 6.1 图表创建流程

```
┌─────────────────────────────────────────────────────────────────────┐
│                      图表创建交互                                    │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  步骤1: 选择图表类型                                                │
│  ┌────────────────────────────────────────────────────────┐        │
│  │  插入图表                                              │        │
│  │                                                        │        │
│  │  ┌────────┐ ┌────────┐ ┌────────┐ ┌────────┐         │        │
│  │  │ 流程图 │ │组织架构│ │思维导图│ │ 时间轴 │         │        │
│  │  │  ◇→□  │ │  ┬─┬  │ │  ├──   │ │ ──●── │         │        │
│  │  └────────┘ └────────┘ └────────┘ └────────┘         │        │
│  │                                                        │        │
│  │  或使用AI生成: [描述您想要的图表...]        [AI生成]  │        │
│  └────────────────────────────────────────────────────────┘        │
│                    ↓                                                │
│  步骤2: 编辑图表                                                    │
│  ┌────────────────────────────────────────────────────────┐        │
│  │  ┌──────────────────────────────────┬────────────────┐│        │
│  │  │                                  │ 节点属性       ││        │
│  │  │      图表编辑画布                │ ─────────────  ││        │
│  │  │                                  │ 文字: [输入]   ││        │
│  │  │    [开始] ──→ [处理] ──→ [结束] │ 形状: [选择▼]  ││        │
│  │  │                                  │ 颜色: [选择]   ││        │
│  │  │                                  │                ││        │
│  │  └──────────────────────────────────┴────────────────┘│        │
│  │  工具: [添加节点] [添加连线] [删除] [撤销] [重做]      │        │
│  └────────────────────────────────────────────────────────┘        │
│                    ↓                                                │
│  步骤3: 完成插入                                                    │
│  ┌────────────────────────────────────────────────────────┐        │
│  │               [取消]  [插入到文档]                     │        │
│  └────────────────────────────────────────────────────────┘        │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 7. 快捷键设计

### 7.1 全局快捷键

| 快捷键 | 功能 | 说明 |
|--------|------|------|
| Ctrl+N | 新建文档 | 打开新建文档对话框 |
| Ctrl+O | 打开/导入 | 打开文件或导入外部文档 |
| Ctrl+S | 保存 | 保存当前文档 |
| Ctrl+Shift+S | 另存为 | 另存为新文件 |
| Ctrl+Shift+E | 导出 | 打开导出对话框 |
| Ctrl+E | 切换环境 | 切换公网/私域 |
| Ctrl+G | AI生成 | 打开AI生成面板 |
| Ctrl+R | AI审核 | 发起AI审核 |
| Ctrl+K | 知识库问答 | 打开知识库问答面板 |
| Ctrl+, | 设置 | 打开设置页面 |
| F1 | 帮助 | 打开帮助文档 |
| F11 | 全屏 | 切换全屏模式 |

### 7.2 编辑快捷键

| 快捷键 | 功能 |
|--------|------|
| Ctrl+Z | 撤销 |
| Ctrl+Y / Ctrl+Shift+Z | 重做 |
| Ctrl+A | 全选 |
| Ctrl+C | 复制 |
| Ctrl+X | 剪切 |
| Ctrl+V | 粘贴 |
| Ctrl+B | 加粗 |
| Ctrl+I | 斜体 |
| Ctrl+U | 下划线 |
| Ctrl+F | 查找 |
| Ctrl+H | 替换 |

---

## 8. 反馈机制

### 8.1 加载状态

| 场景 | 反馈方式 |
|------|----------|
| 页面加载 | 全屏加载动画 + Logo |
| 文档加载 | 骨架屏 |
| AI请求 | 按钮loading + 进度提示 |
| 导出中 | 进度条 + 百分比 |
| 文档导入 | 步骤进度条 + 当前步骤说明 |
| 知识库索引 | 进度条 + 文档处理状态列表 |
| 向量检索 | 加载动画 + "正在检索知识库..." |

### 8.2 操作反馈

| 操作 | 反馈方式 |
|------|----------|
| 保存成功 | 状态栏显示"已保存" + 淡出 |
| 保存失败 | 弹出错误提示 |
| 复制成功 | Toast提示"已复制" |
| 环境切换 | Toast提示 + 界面变化 |
| AI生成完成 | 声音提示(可选) + 内容显示 |
| 导入成功 | Toast提示"导入成功，共X页" |
| 导出成功 | Toast提示"已导出到: 文件路径" + 打开文件夹按钮 |
| 加入知识库 | Toast提示"已添加到知识库" |
| 知识库问答 | 流式输出回答 + 引用来源高亮 |

### 8.3 错误处理

| 错误场景 | 处理方式 |
|----------|----------|
| 导入格式不支持 | 弹窗提示支持的格式列表 |
| PDF OCR识别失败 | 提示切换识别模式或检查文件 |
| 知识库创建失败 | 显示具体错误原因，提供重试选项 |
| 向量模型加载失败 | 提示检查模型文件，提供下载链接 |
| AI服务不可用 | 显示服务状态，建议切换环境或稍后重试 |

---

## 9. 编辑器交互细节

### 9.1 光标与选区行为

```
┌─────────────────────────────────────────────────────────────────────┐
│                      光标与选区行为                                  │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  光标样式:                                                          │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │  正常编辑状态: │ (闪烁的竖线，1px宽，主题色)                 │   │
│  │  只读状态: 无光标显示                                        │   │
│  │  不可编辑区域: 光标变为 not-allowed                         │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│  选区行为:                                                          │
│                                                                     │
│  1. 单击定位                                                        │
│     • 点击文本: 光标定位到点击位置                                  │
│     • 点击空白: 光标定位到最近的文本末尾                            │
│                                                                     │
│  2. 双击选词                                                        │
│     • 中文: 选中连续的中文字符                                      │
│     • 英文: 选中完整的单词                                          │
│     • 数字: 选中连续的数字                                          │
│                                                                     │
│  3. 三击选段                                                        │
│     • 选中当前整个段落                                              │
│                                                                     │
│  4. 拖拽选择                                                        │
│     • 按住鼠标拖动: 选择经过的文本                                  │
│     • 选中文本高亮: 背景色 rgba(主题色, 0.2)                        │
│                                                                     │
│  5. 多选区 (Ctrl+点击)                                              │
│     • 支持创建多个不连续的选区                                      │
│     • 同时编辑多处相同内容                                          │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 9.2 键盘导航

```
┌─────────────────────────────────────────────────────────────────────┐
│                      编辑器键盘导航                                  │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  基础导航:                                                          │
│  ┌────────────────┬────────────────────────────────────────────┐   │
│  │ 按键           │ 行为                                       │   │
│  ├────────────────┼────────────────────────────────────────────┤   │
│  │ ← / →          │ 移动一个字符                               │   │
│  │ ↑ / ↓          │ 移动一行                                   │   │
│  │ Home           │ 移动到行首                                  │   │
│  │ End            │ 移动到行尾                                  │   │
│  │ Ctrl + Home    │ 移动到文档开头                              │   │
│  │ Ctrl + End     │ 移动到文档末尾                              │   │
│  │ Ctrl + ← / →   │ 按词移动                                   │   │
│  │ Page Up/Down   │ 上/下翻页                                   │   │
│  └────────────────┴────────────────────────────────────────────┘   │
│                                                                     │
│  选择扩展 (Shift + 导航键):                                         │
│  • Shift + ← / →: 扩展选区一个字符                                 │
│  • Shift + Ctrl + ← / →: 扩展选区一个词                            │
│  • Shift + ↑ / ↓: 扩展选区一行                                     │
│  • Shift + Home/End: 选择到行首/行尾                               │
│  • Ctrl + A: 全选                                                   │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 9.3 撤销重做系统

```
┌─────────────────────────────────────────────────────────────────────┐
│                      撤销重做系统设计                                │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  操作记录粒度:                                                      │
│                                                                     │
│  1. 文本输入                                                        │
│     • 连续输入合并为一次操作 (停顿超过500ms分割)                    │
│     • 输入完成后换行/空格触发记录点                                 │
│                                                                     │
│  2. 格式操作                                                        │
│     • 每次格式更改记录为独立操作                                    │
│     • 批量格式化作为单次操作                                        │
│                                                                     │
│  3. 删除操作                                                        │
│     • 连续删除合并 (Backspace/Delete)                               │
│     • 选中删除作为单次操作                                          │
│                                                                     │
│  4. 粘贴操作                                                        │
│     • 每次粘贴作为单次操作                                          │
│                                                                     │
│  5. AI操作                                                          │
│     • AI插入内容作为单次操作，支持一键撤销                          │
│                                                                     │
│  撤销栈:                                                            │
│  ┌────────────────────────────────────────────────────────────┐    │
│  │  操作1 → 操作2 → 操作3 → 操作4 → 当前状态                   │    │
│  │                                    ↑                        │    │
│  │                              撤销指针                        │    │
│  └────────────────────────────────────────────────────────────┘    │
│                                                                     │
│  限制:                                                              │
│  • 最大撤销步数: 100步                                              │
│  • 关闭文档后撤销历史清空                                           │
│  • 保存后可继续撤销到保存前状态                                     │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 10. 拖放交互设计

### 10.1 拖放类型

```
┌─────────────────────────────────────────────────────────────────────┐
│                      拖放交互类型                                    │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  1. 文本拖放 (编辑器内)                                             │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │  选中文本 ─────────────────→ 目标位置                        │   │
│  │  "这是拖动的文本"        ↘                                   │   │
│  │                           这里是目标位置│                    │   │
│  │                                                              │   │
│  │  行为:                                                       │   │
│  │  • 默认: 移动文本                                            │   │
│  │  • Ctrl+拖动: 复制文本                                       │   │
│  │  • 拖动时显示插入光标                                        │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│  2. 素材拖放 (素材库 → 编辑器)                                      │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │  素材库                     编辑器                            │   │
│  │  ┌────────────┐            ┌──────────────────────────────┐ │   │
│  │  │ 📝 常用短语│ ────────→ │ 这里是编辑内容│               │ │   │
│  │  │ "特此通知" │            │                              │ │   │
│  │  └────────────┘            └──────────────────────────────┘ │   │
│  │                                                              │   │
│  │  行为:                                                       │   │
│  │  • 拖动时素材跟随鼠标 (半透明预览)                           │   │
│  │  • 编辑器显示插入指示线                                      │   │
│  │  • 释放后插入素材内容                                        │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│  3. 文件拖放 (外部文件 → 应用)                                      │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │  外部文件                   应用窗口                          │   │
│  │  📄 工作报告.docx ────────→ ┌──────────────────────────────┐│   │
│  │                            │                              ││   │
│  │                            │   放置以导入文档             ││   │
│  │                            │                              ││   │
│  │                            └──────────────────────────────┘│   │
│  │                                                              │   │
│  │  行为:                                                       │   │
│  │  • 进入应用窗口时显示拖放提示蒙层                            │   │
│  │  • 支持格式: DOCX、PDF、MD、TXT                              │   │
│  │  • 释放后打开导入对话框                                      │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│  4. 文档拖放 (文档列表内)                                           │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │  行为:                                                       │   │
│  │  • 拖动文档到文件夹: 移动文档                                │   │
│  │  • 拖动文档到收藏: 添加收藏                                  │   │
│  │  • 拖动文档到知识库: 添加到知识库                            │   │
│  │  • 拖动文档到回收站: 删除文档                                │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 10.2 拖放视觉反馈

```
┌─────────────────────────────────────────────────────────────────────┐
│                      拖放视觉反馈                                    │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  拖动开始:                                                          │
│  • 原位置元素变为半透明 (opacity: 0.5)                              │
│  • 鼠标样式: grabbing                                               │
│  • 拖动镜像: 元素缩略预览跟随鼠标                                   │
│                                                                     │
│  拖动过程:                                                          │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │  可放置区域:                                                 │   │
│  │  • 边框变为主题色虚线                                        │   │
│  │  • 背景色变浅 (rgba(主题色, 0.05))                           │   │
│  │  • 显示放置提示文字                                          │   │
│  │                                                              │   │
│  │  不可放置区域:                                               │   │
│  │  • 鼠标样式: not-allowed                                     │   │
│  │  • 无视觉变化                                                │   │
│  │                                                              │   │
│  │  插入位置指示:                                               │   │
│  │  • 显示蓝色插入线 (2px)                                      │   │
│  │  • 线条两端显示小圆点                                        │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│  释放完成:                                                          │
│  • 执行对应操作                                                     │
│  • 显示完成动画 (元素滑入效果)                                      │
│  • Toast提示操作结果                                                │
│                                                                     │
│  取消拖放 (Esc):                                                    │
│  • 元素回到原位                                                     │
│  • 恢复所有视觉状态                                                 │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 11. 多选操作交互

### 11.1 文档多选

```
┌─────────────────────────────────────────────────────────────────────┐
│                      文档多选交互                                    │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  选择方式:                                                          │
│                                                                     │
│  1. 逐个选择 (Ctrl+点击)                                            │
│     ┌─────────────────────────────────────────────────────────┐    │
│     │  ☑ 📄 文档1                                             │    │
│     │  ☐ 📄 文档2                                             │    │
│     │  ☑ 📄 文档3     ◄─ Ctrl+点击切换选中状态               │    │
│     │  ☐ 📄 文档4                                             │    │
│     └─────────────────────────────────────────────────────────┘    │
│                                                                     │
│  2. 范围选择 (Shift+点击)                                           │
│     ┌─────────────────────────────────────────────────────────┐    │
│     │  ☑ 📄 文档1     ◄─ 先点击                              │    │
│     │  ☑ 📄 文档2     ◄─ (自动选中)                          │    │
│     │  ☑ 📄 文档3     ◄─ (自动选中)                          │    │
│     │  ☑ 📄 文档4     ◄─ Shift+点击                          │    │
│     └─────────────────────────────────────────────────────────┘    │
│                                                                     │
│  3. 全选 (Ctrl+A)                                                   │
│     • 选中当前视图所有文档                                          │
│                                                                     │
│  4. 框选 (鼠标拖动矩形)                                             │
│     • 仅卡片视图支持                                                │
│     • 拖动绘制选择框                                                │
│     • 框内文档自动选中                                              │
│                                                                     │
│  多选后操作栏:                                                      │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │  已选择 3 个文档     [批量导出] [移动到] [删除]     [取消]  │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 11.2 批量操作

```
┌─────────────────────────────────────────────────────────────────────┐
│                      批量操作交互                                    │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  批量导出:                                                          │
│  ┌────────────────────────────────────────┐                        │
│  │  批量导出                               │                        │
│  │  ──────────────────────────────────── │                        │
│  │                                        │                        │
│  │  已选择 5 个文档                       │                        │
│  │  ┌──────────────────────────────────┐ │                        │
│  │  │ ☑ 会议通知.rdoc                   │ │                        │
│  │  │ ☑ 工作报告.rdoc                   │ │                        │
│  │  │ ☑ 项目请示.rdoc                   │ │                        │
│  │  │ ☑ 批复文件.rdoc                   │ │                        │
│  │  │ ☑ 会议纪要.rdoc                   │ │                        │
│  │  └──────────────────────────────────┘ │                        │
│  │                                        │                        │
│  │  导出格式: [DOCX         ▼]            │                        │
│  │  ☑ 每个文档单独导出                    │                        │
│  │  ☐ 合并为一个文件                      │                        │
│  │                                        │                        │
│  │              [取消]  [批量导出]        │                        │
│  └────────────────────────────────────────┘                        │
│                                                                     │
│  批量移动:                                                          │
│  ┌────────────────────────────────────────┐                        │
│  │  移动到                                 │                        │
│  │  ──────────────────────────────────── │                        │
│  │                                        │                        │
│  │  选择目标位置:                         │                        │
│  │  ┌──────────────────────────────────┐ │                        │
│  │  │ 📁 我的文档                       │ │                        │
│  │  │   📁 工作文档                     │ │                        │
│  │  │   📁 会议文档  ◄─ 选中            │ │                        │
│  │  │   📁 项目文档                     │ │                        │
│  │  └──────────────────────────────────┘ │                        │
│  │                                        │                        │
│  │  [+ 新建文件夹]                        │                        │
│  │                                        │                        │
│  │              [取消]  [移动]            │                        │
│  └────────────────────────────────────────┘                        │
│                                                                     │
│  批量删除:                                                          │
│  ┌────────────────────────────────────────┐                        │
│  │  🗑️ 删除确认                           │                        │
│  │  ──────────────────────────────────── │                        │
│  │                                        │                        │
│  │  确定要删除以下 5 个文档吗？           │                        │
│  │  文档将移至回收站，可在30天内恢复。    │                        │
│  │                                        │                        │
│  │  ☐ 不再提示 (本次会话)                 │                        │
│  │                                        │                        │
│  │              [取消]  [删除]            │                        │
│  └────────────────────────────────────────┘                        │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 12. 调整大小交互

### 12.1 面板调整

```
┌─────────────────────────────────────────────────────────────────────┐
│                      面板大小调整                                    │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  可调整区域:                                                        │
│  ┌────┬───────────────┬──────────────────────────┬─────────────┐   │
│  │活动│    侧边栏     │         编辑区           │   AI面板    │   │
│  │栏  │◄───调整───►   │                          │◄──调整──►   │   │
│  │    │               │                          │             │   │
│  │固定│  200-400px    │         自适应           │  280-500px  │   │
│  │48px│               │                          │             │   │
│  └────┴───────────────┴──────────────────────────┴─────────────┘   │
│                                                                     │
│  交互行为:                                                          │
│                                                                     │
│  1. 悬停分隔线                                                      │
│     • 分隔线高亮显示 (主题色)                                       │
│     • 鼠标样式变为 col-resize                                       │
│                                                                     │
│  2. 拖动分隔线                                                      │
│     • 实时调整面板宽度                                              │
│     • 显示当前宽度数值 (Tooltip)                                    │
│     • 达到最小/最大值时显示边界提示                                 │
│                                                                     │
│  3. 双击分隔线                                                      │
│     • 重置为默认宽度                                                │
│                                                                     │
│  4. 自动吸附                                                        │
│     • 拖动到最小值附近时自动折叠面板                                │
│     • 吸附阈值: 50px                                                │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 12.2 图表元素调整

```
┌─────────────────────────────────────────────────────────────────────┐
│                      图表元素调整                                    │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  选中图表节点后:                                                    │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │                                                             │   │
│  │      ○─────────────────────○                                │   │
│  │      │                     │                                │   │
│  │      │    选中的节点       │                                │   │
│  │      │                     │                                │   │
│  │      ○─────────────────────○                                │   │
│  │                                                             │   │
│  │  ○ 角点: 等比例缩放                                         │   │
│  │  │ 边线中点: 单向拉伸                                       │   │
│  │                                                             │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│  调整行为:                                                          │
│  • 拖动角点: 保持宽高比缩放                                         │
│  • 拖动边中点: 单向调整宽/高                                        │
│  • Shift+拖动: 强制等比例缩放                                       │
│  • Alt+拖动: 从中心缩放                                             │
│                                                                     │
│  对齐辅助:                                                          │
│  • 调整时显示与其他元素的对齐参考线                                 │
│  • 自动吸附到对齐位置                                               │
│  • 显示元素间距数值                                                 │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 13. 手势与触控交互

### 13.1 触控板手势

```
┌─────────────────────────────────────────────────────────────────────┐
│                      触控板手势支持                                  │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  双指操作:                                                          │
│  ┌────────────────────────────────────────────────────────────┐    │
│  │  手势           │ 操作                                     │    │
│  ├────────────────────────────────────────────────────────────┤    │
│  │  双指上下滑动   │ 垂直滚动文档                             │    │
│  │  双指左右滑动   │ 水平滚动 (表格等宽内容)                  │    │
│  │  双指捏合       │ 缩放预览视图                             │    │
│  │  双指展开       │ 放大预览视图                             │    │
│  └────────────────────────────────────────────────────────────┘    │
│                                                                     │
│  缩放级别:                                                          │
│  • 最小缩放: 50%                                                    │
│  • 默认缩放: 100%                                                   │
│  • 最大缩放: 200%                                                   │
│  • 快捷键: Ctrl+滚轮 也可缩放                                       │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 13.2 触摸屏支持

```
┌─────────────────────────────────────────────────────────────────────┐
│                      触摸屏交互                                      │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  基础触摸:                                                          │
│  • 点击: 等同于鼠标单击                                             │
│  • 长按: 等同于鼠标右键，显示上下文菜单                             │
│  • 双击: 等同于鼠标双击，选中词                                     │
│                                                                     │
│  滑动操作:                                                          │
│  • 单指滑动: 滚动页面                                               │
│  • 双指滑动: 同触控板                                               │
│                                                                     │
│  拖放操作:                                                          │
│  • 长按后拖动: 拖动元素                                             │
│  • 需要视觉反馈确认拖动开始                                         │
│                                                                     │
│  适配优化:                                                          │
│  • 增大点击目标区域 (最小 44×44px)                                  │
│  • 增加按钮间距                                                     │
│  • 显示软键盘时自动调整布局                                         │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 14. 自动保存与恢复

### 14.1 自动保存机制

```
┌─────────────────────────────────────────────────────────────────────┐
│                      自动保存机制                                    │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  触发条件:                                                          │
│  • 停止输入 3秒后自动保存                                           │
│  • 切换到其他文档/标签页时                                          │
│  • 执行重要操作前 (如AI生成)                                        │
│  • 窗口失去焦点时                                                   │
│  • 定时保存: 每 30秒                                                │
│                                                                     │
│  保存状态指示:                                                      │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │  保存中:    [⟳] 保存中...                                    │   │
│  │  已保存:    [✓] 已保存 14:30                                 │   │
│  │  保存失败:  [!] 保存失败 - 点击重试                          │   │
│  │  有未保存:  [●] 未保存更改                                   │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│  位置: 底部状态栏中显示                                             │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 14.2 崩溃恢复

```
┌─────────────────────────────────────────────────────────────────────┐
│                      崩溃恢复流程                                    │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  检测到未保存内容恢复:                                              │
│  ┌────────────────────────────────────────┐                        │
│  │  检测到未保存的内容                     │                        │
│  │  ──────────────────────────────────── │                        │
│  │                                        │                        │
│  │  上次意外关闭时，以下文档有未保存的    │                        │
│  │  更改:                                 │                        │
│  │                                        │                        │
│  │  ┌──────────────────────────────────┐ │                        │
│  │  │ 📄 工作报告.rdoc                  │ │                        │
│  │  │    最后编辑: 2026-02-28 14:30     │ │                        │
│  │  │    未保存字数: 约 200 字          │ │                        │
│  │  └──────────────────────────────────┘ │                        │
│  │                                        │                        │
│  │  [忽略恢复]  [恢复编辑]               │                        │
│  └────────────────────────────────────────┘                        │
│                                                                     │
│  恢复后:                                                            │
│  • 文档标记为"已恢复"状态                                          │
│  • 提示用户检查内容并保存                                           │
│  • 恢复内容高亮显示 (可选)                                          │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 15. 无障碍交互支持

### 15.1 键盘无障碍

```
┌─────────────────────────────────────────────────────────────────────┐
│                      键盘无障碍支持                                  │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  焦点管理:                                                          │
│  • Tab 键按逻辑顺序在可交互元素间移动                               │
│  • Shift+Tab 反向移动焦点                                           │
│  • Enter/Space 激活当前焦点元素                                     │
│  • Esc 关闭模态框/取消操作                                          │
│                                                                     │
│  焦点顺序:                                                          │
│  顶部状态栏 → 活动栏 → 侧边栏 → 工具栏 → 编辑区 → AI面板           │
│                                                                     │
│  焦点可见性:                                                        │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │  焦点样式:                                                   │   │
│  │  • 使用2px实线轮廓 (outline)                                 │   │
│  │  • 颜色: 主题色                                              │   │
│  │  • 偏移: 2px (outline-offset)                                │   │
│  │  • 不使用虚线或不明显的样式                                  │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│  模态框焦点陷阱:                                                    │
│  • 打开模态框时焦点自动移入                                         │
│  • Tab 在模态框内循环                                               │
│  • 关闭时焦点返回触发元素                                           │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 15.2 屏幕阅读器支持

```
┌─────────────────────────────────────────────────────────────────────┐
│                      屏幕阅读器支持                                  │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  语义化标记:                                                        │
│  • 使用正确的 HTML 语义元素                                         │
│  • 标题层级正确 (h1 > h2 > h3...)                                   │
│  • 表单元素关联 label                                               │
│  • 列表使用 ul/ol 标记                                              │
│                                                                     │
│  ARIA 属性:                                                         │
│  • aria-label: 为图标按钮提供文字说明                               │
│  • aria-expanded: 标记可展开区域状态                                │
│  • aria-selected: 标记选中状态                                      │
│  • aria-live: 动态内容区域通知                                      │
│  • role: 自定义组件角色说明                                         │
│                                                                     │
│  动态内容通知:                                                      │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │  aria-live 区域:                                             │   │
│  │  • 保存状态变化: aria-live="polite"                          │   │
│  │  • 错误提示: aria-live="assertive"                           │   │
│  │  • AI 生成进度: aria-live="polite"                           │   │
│  │  • 环境切换: aria-live="assertive"                           │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

*文档结束*
