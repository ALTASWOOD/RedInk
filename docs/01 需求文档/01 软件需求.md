# RedInk 公文报告编写软件 产品需求文档（PRD）

---

## 文档信息

| 项目 | 内容 |
|------|------|
| 产品名称 | RedInk 公文报告编写软件 |
| 文档版本 | V1.1 |
| 文档状态 | 已更新 |
| 创建日期 | 2026-02-28 |
| 最后更新 | 2026-02-28 |

---

## 目录

1. [文档概述](#1-文档概述)
2. [产品概述](#2-产品概述)
3. [用户分析](#3-用户分析)
4. [功能需求](#4-功能需求)
   - 4.1 公文编写模块
   - 4.2 文档管理模块
   - 4.3 素材库管理模块
   - 4.4 AI审核模块
   - 4.5 AI集成模块
   - 4.6 图表绘制模块
5. [非功能需求](#5-非功能需求)
6. [界面设计要求](#6-界面设计要求)
7. [技术架构建议](#7-技术架构建议)
8. [数据安全设计](#8-数据安全设计)
9. [项目里程碑](#9-项目里程碑)
10. [附录](#10-附录)

---

## 1. 文档概述

### 1.1 文档目的

本文档旨在详细描述 RedInk 公文报告编写软件的产品需求，为产品设计、开发、测试提供明确的需求依据。本文档面向产品经理、UI设计师、开发工程师、测试工程师及项目相关干系人。

### 1.2 文档范围

本文档涵盖以下内容：
- 产品功能需求的完整描述
- 非功能性需求（性能、安全、可用性等）
- 界面设计规范与要求
- 技术架构建议
- 数据安全设计方案

### 1.3 术语定义

| 术语 | 定义 |
|------|------|
| 公文 | 机关、团体、企事业单位在公务活动中形成的具有法定效力和规范格式的文书 |
| AI | 人工智能（Artificial Intelligence），本文特指大语言模型服务 |
| 公网环境 | 通过互联网访问的云端AI服务环境 |
| 私域环境 | 部署在本地或内网的AI服务环境，数据不经过公网传输 |
| LLM | 大语言模型（Large Language Model） |
| 本地AI | 部署在用户本地计算机或内网服务器上的AI模型 |

### 1.4 参考文档

- 《党政机关公文格式》（GB/T 9704-2012）
- 《党政机关公文处理工作条例》
- 原始需求文档

---

## 2. 产品概述

### 2.1 产品背景

随着数字化办公的普及，公文报告的编写工作量日益增加。传统的公文编写方式存在以下问题：
- 公文格式规范复杂，容易出错
- 编写效率低，耗费大量人力和时间
- 内容审核依赖人工，容易遗漏问题
- 使用云端AI服务时，存在敏感信息泄露风险

### 2.2 产品定位

**RedInk** 是一款 **AI驱动的公文报告编写软件**，专注于提供安全、高效、智能的公文编写解决方案。

**核心定位**：安全可控的AI公文助手

### 2.3 产品目标

1. **提升效率**：通过AI辅助，将公文编写效率提升50%以上
2. **保障质量**：AI智能审核，降低格式错误率至5%以下
3. **确保安全**：公私隔离设计，杜绝敏感信息泄露风险
4. **灵活适配**：支持多种AI接口，满足不同场景需求

### 2.4 核心价值主张

**公私隔离、安全可控** —— 这是 RedInk 区别于其他AI写作工具的核心特点。

- 明确区分公网AI和私域AI环境
- 通过界面颜色和视觉元素清晰标识当前环境
- 用户可根据内容敏感程度选择合适的AI环境
- 私域环境数据完全本地处理，不经过任何公网传输

---

## 3. 用户分析

### 3.1 目标用户群体

| 用户类型 | 描述 | 典型场景 |
|----------|------|----------|
| 政府机关文秘 | 负责起草、审核政府公文的工作人员 | 起草会议纪要、通知、报告等 |
| 企事业单位行政人员 | 处理企业内部公文、报告的员工 | 编写工作总结、请示、函件等 |
| 国有企业文职人员 | 需要处理涉密或敏感信息的文职人员 | 编写内部报告、专项汇报材料 |
| 科研机构研究人员 | 需要撰写项目报告、研究报告的人员 | 编写项目申报书、研究报告 |

### 3.2 用户痛点分析

| 痛点 | 详细描述 | 期望解决方案 |
|------|----------|--------------|
| 格式规范复杂 | 公文格式要求严格，字号、行距、页边距等规范繁多 | 提供标准模板，自动套用格式 |
| 编写效率低 | 从构思到成稿耗时较长，重复性工作多 | AI辅助生成内容框架和初稿 |
| 审核困难 | 人工审核易遗漏，缺乏系统化检查 | AI智能审核，全面检查内容和格式 |
| 信息安全顾虑 | 担心使用云端AI导致敏感信息泄露 | 提供本地AI选项，公私隔离 |
| 多格式输出麻烦 | 需要输出多种格式时转换繁琐 | 一键导出DOC、PDF、MD多种格式 |

### 3.3 使用场景描述

**场景一：日常公文编写（公网环境）**
> 张秘书需要起草一份普通的会议通知。她打开RedInk，确认当前处于「公网环境」（蓝色界面），选择"会议通知"模板，输入会议主题和要点，AI快速生成通知初稿，她稍作修改后导出为DOC格式。

**场景二：涉密报告编写（私域环境）**
> 李主任需要编写一份涉及内部数据的工作报告。他切换到「私域环境」（绿色界面），系统提示"当前使用本地AI，数据不经过公网"。他放心地输入相关内容，本地AI辅助完成报告编写，全程数据不离开本地。

**场景三：报告审核与修改**
> 王科长收到一份下属起草的报告，需要审核。他将文档导入RedInk，使用AI审核功能，系统自动检查格式规范、内容逻辑、用词是否恰当，并给出修改建议。

---

## 4. 功能需求

### 4.1 公文编写模块

#### 4.1.1 公文模板管理

**功能描述**：提供标准公文模板库，支持模板的增删改查和自定义。

| 功能点 | 优先级 | 详细描述 |
|--------|--------|----------|
| 预置模板库 | P0 | 内置常用公文模板：通知、报告、请示、批复、函、会议纪要等 |
| 模板分类管理 | P1 | 按公文类型、使用频率、部门等维度分类管理模板 |
| 自定义模板 | P1 | 用户可基于现有模板修改或从零创建新模板 |
| 模板导入导出 | P2 | 支持模板的导入导出，便于团队共享 |
| 模板版本管理 | P2 | 记录模板修改历史，支持版本回退 |

**模板要素**：
- 标题格式（字体、字号、位置）
- 正文格式（字体、字号、行距、段落）
- 落款格式（签发单位、日期位置）
- 页面设置（纸张大小、页边距）
- 页眉页脚设置

#### 4.1.2 AI辅助编写

**功能描述**：利用AI技术辅助用户完成公文内容的编写。

| 功能点 | 优先级 | 详细描述 |
|--------|--------|----------|
| 内容生成 | P0 | 根据用户输入的要点、关键词生成公文初稿 |
| 智能续写 | P0 | 基于已有内容智能续写后续段落 |
| 内容改写 | P1 | 对选中内容进行润色、精简、扩展等改写 |
| 多方案生成 | P1 | 同一需求生成多个版本供用户选择 |
| 语气调整 | P2 | 调整公文语气（正式/简洁/详尽等） |
| 历史学习 | P2 | 学习用户历史公文风格，生成更贴合的内容 |

**交互流程**：
1. 用户选择公文类型和模板
2. 输入公文主题、要点、背景信息
3. AI生成公文初稿
4. 用户审阅、修改、确认
5. 可随时调用AI进行局部优化

#### 4.1.3 多格式输出

**功能描述**：支持将公文导出为多种标准格式。

| 输出格式 | 优先级 | 详细描述 |
|----------|--------|----------|
| DOCX | P0 | Microsoft Word格式，保留完整格式和样式 |
| PDF | P0 | 便携文档格式，适合打印和归档 |
| Markdown | P1 | 纯文本标记格式，便于版本管理和二次处理 |
| HTML | P2 | 网页格式，适合在线预览和分享 |
| OFD | P2 | 国产版式文档格式，符合政务要求 |

**格式要求**：
- DOCX输出需完全符合《党政机关公文格式》标准
- PDF输出需支持书签、目录导航
- 支持批量导出多种格式

### 4.2 文档管理模块

#### 4.2.1 文档列表管理

**功能描述**：提供完整的文档管理功能，支持文档的创建、编辑、查看、删除等操作。

| 功能点 | 优先级 | 详细描述 |
|--------|--------|----------|
| 文档列表视图 | P0 | 支持列表视图和卡片视图两种展示方式 |
| 文档筛选 | P0 | 按文档类型、环境、创建时间、状态等多维度筛选 |
| 文档搜索 | P0 | 支持标题、内容全文搜索 |
| 文档排序 | P1 | 按修改时间、创建时间、名称等排序 |
| 批量操作 | P1 | 支持批量删除、批量导出、批量移动等操作 |
| 文档标签 | P2 | 支持自定义标签，便于分类管理 |

#### 4.2.2 文档分类管理

**功能描述**：通过文件夹和标签实现文档的分类组织。

| 功能点 | 优先级 | 详细描述 |
|--------|--------|----------|
| 文件夹管理 | P0 | 支持创建、重命名、删除文件夹，支持多级目录 |
| 收藏功能 | P0 | 支持收藏常用文档，快速访问 |
| 最近使用 | P0 | 自动记录最近编辑的文档列表 |
| 回收站 | P1 | 删除的文档进入回收站，支持恢复或彻底删除 |
| 环境分组 | P0 | 按公网/私域环境自动分组显示文档 |

#### 4.2.3 文档版本管理

**功能描述**：记录文档修改历史，支持版本对比和回退。

| 功能点 | 优先级 | 详细描述 |
|--------|--------|----------|
| 自动保存 | P0 | 编辑时自动保存，防止数据丢失 |
| 版本历史 | P1 | 记录每次保存的版本，支持查看历史版本 |
| 版本对比 | P2 | 对比不同版本之间的差异 |
| 版本回退 | P1 | 支持回退到任意历史版本 |

### 4.3 素材库管理模块

#### 4.3.1 素材库概述

**功能描述**：提供素材库功能，用于存储和管理公文编写中常用的素材内容。

**素材类型**：
- 常用短语：常用的公文开头语、结束语、过渡语等
- 段落模板：可复用的段落内容模板
- 图片素材：公章图片、签名图片、常用配图等
- 表格模板：常用表格格式模板
- 签章素材：电子签章、印章图片等

#### 4.3.2 常用短语管理

**功能描述**：管理公文编写中常用的短语和表达方式。

| 功能点 | 优先级 | 详细描述 |
|--------|--------|----------|
| 预置短语库 | P0 | 内置常用公文短语：开头语、结束语、过渡语、敬语等 |
| 自定义短语 | P0 | 用户可添加、编辑、删除自定义短语 |
| 短语分类 | P1 | 按用途分类：开头语、结束语、过渡语、请示用语、批复用语等 |
| 快速插入 | P0 | 编辑时可快速搜索并插入常用短语 |
| 使用统计 | P2 | 记录短语使用频率，智能排序推荐 |

**预置短语示例**：

| 分类 | 示例短语 |
|------|----------|
| 开头语 | "为进一步..."、"根据...要求"、"为贯彻落实..." |
| 结束语 | "特此通知"、"请予以批准"、"妥否，请批示" |
| 过渡语 | "综上所述"、"鉴于上述情况"、"为此，建议..." |
| 请示用语 | "当否，请批示"、"以上请示，请予审批"、"恳请批准" |
| 批复用语 | "经研究，同意..."、"原则同意"、"不予同意，理由如下..." |

#### 4.3.3 段落模板管理

**功能描述**：管理可复用的段落内容模板。

| 功能点 | 优先级 | 详细描述 |
|--------|--------|----------|
| 预置段落模板 | P1 | 内置常用段落模板：工作背景、目标任务、保障措施等 |
| 自定义段落 | P1 | 用户可创建自定义段落模板，支持变量占位符 |
| 段落分类 | P1 | 按公文类型和用途分类管理 |
| 变量替换 | P1 | 支持变量占位符，插入时自动提示填写 |
| 段落预览 | P2 | 插入前可预览段落内容和格式 |

#### 4.3.4 图片素材管理

**功能描述**：管理公文中使用的图片素材。

| 功能点 | 优先级 | 详细描述 |
|--------|--------|----------|
| 图片上传 | P0 | 支持上传PNG、JPG、SVG等格式图片 |
| 图片分类 | P1 | 按用途分类：公章、签名、配图、图标等 |
| 图片预览 | P0 | 缩略图预览和大图查看 |
| 快速插入 | P0 | 编辑文档时可快速搜索并插入图片 |
| 图片编辑 | P2 | 简单的裁剪、缩放功能 |

#### 4.3.5 表格模板管理

**功能描述**：管理公文中常用的表格格式模板。

| 功能点 | 优先级 | 详细描述 |
|--------|--------|----------|
| 预置表格模板 | P1 | 内置常用表格：人员名单、经费预算、进度安排等 |
| 自定义表格 | P1 | 用户可创建自定义表格模板 |
| 表格样式 | P1 | 支持设置表格样式：边框、背景色、字体等 |
| 快速插入 | P0 | 编辑时可快速插入表格模板 |
| 表格数据导入 | P2 | 支持从Excel导入表格数据 |

#### 4.3.6 素材库搜索与推荐

**功能描述**：提供智能搜索和推荐功能，提升素材使用效率。

| 功能点 | 优先级 | 详细描述 |
|--------|--------|----------|
| 全局搜索 | P0 | 跨素材类型搜索，支持关键词匹配 |
| 智能推荐 | P1 | 根据当前编辑的公文类型推荐相关素材 |
| 最近使用 | P0 | 显示最近使用的素材，快速复用 |
| 收藏素材 | P1 | 支持收藏常用素材，优先展示 |

### 4.4 AI审核模块

#### 4.4.1 内容审核

**功能描述**：对公文内容进行智能审核，检查内容质量和逻辑性。

| 审核项 | 优先级 | 详细描述 |
|--------|--------|----------|
| 逻辑检查 | P0 | 检查文章结构是否清晰，论述是否有逻辑性 |
| 事实核查 | P1 | 检查数据、日期、人名等是否准确一致 |
| 政策合规 | P1 | 检查内容是否符合相关政策法规要求 |
| 敏感词检测 | P0 | 检测并标记敏感词汇和不当表述 |
| 重复检查 | P2 | 检查是否存在重复或冗余的表述 |

#### 4.4.2 格式审核

**功能描述**：检查公文格式是否符合规范标准。

| 审核项 | 优先级 | 详细描述 |
|--------|--------|----------|
| 字体字号检查 | P0 | 检查标题、正文等字体字号是否符合规范 |
| 行距段距检查 | P0 | 检查行距、段落间距是否符合标准 |
| 页面设置检查 | P0 | 检查页边距、纸张大小等是否正确 |
| 序号格式检查 | P1 | 检查各级序号格式是否规范统一 |
| 标点符号检查 | P1 | 检查标点符号使用是否正确 |

#### 4.4.3 审核报告

**功能描述**：生成详细的审核报告，便于用户定位和修改问题。

| 功能点 | 优先级 | 详细描述 |
|--------|--------|----------|
| 问题列表 | P0 | 列出所有发现的问题，按严重程度排序 |
| 问题定位 | P0 | 点击问题可直接定位到文档对应位置 |
| 修改建议 | P1 | 针对每个问题给出具体的修改建议 |
| 一键修复 | P1 | 支持一键自动修复部分格式问题 |
| 报告导出 | P2 | 支持将审核报告导出为独立文档 |

### 4.5 AI集成模块

#### 4.5.1 多AI接口支持

**功能描述**：支持接入多种AI服务提供商，用户可灵活选择。

| AI类型 | 优先级 | 说明 |
|--------|--------|------|
| OpenAI (GPT系列) | P1 | 国际主流大模型，能力全面 |
| Anthropic (Claude) | P1 | 长文本处理能力强 |
| 国产大模型 | P0 | 文心一言、通义千问、讯飞星火等 |
| 自定义API | P2 | 支持用户配置自定义的API接口 |

**接口配置**：
- API密钥管理（加密存储）
- 接口地址配置
- 模型版本选择
- 请求参数配置（温度、最大token等）
- 连接测试功能

#### 4.5.2 本地AI部署支持

**功能描述**：支持使用本地部署的AI模型，确保数据安全。

| 功能点 | 优先级 | 详细描述 |
|--------|--------|----------|
| Ollama集成 | P0 | 支持Ollama本地模型服务 |
| LM Studio集成 | P1 | 支持LM Studio本地模型 |
| 自定义本地服务 | P1 | 支持配置自定义的本地AI服务地址 |
| 模型管理 | P2 | 查看、下载、删除本地模型 |
| 性能监控 | P2 | 监控本地模型运行状态和资源占用 |

**本地部署要求**：
- 支持的模型格式：GGUF、GGML等
- 推荐配置：16GB+内存，支持GPU加速
- 推荐模型：Qwen、ChatGLM、Llama等开源模型

#### 4.5.3 公网/私域环境切换（核心特性）

**功能描述**：提供清晰的公网/私域环境切换机制，这是本产品的核心差异化特性。

| 功能点 | 优先级 | 详细描述 |
|--------|--------|----------|
| 环境切换 | P0 | 一键切换公网环境和私域环境 |
| 环境状态显示 | P0 | 界面顶部始终显示当前环境状态 |
| 切换确认 | P0 | 切换环境时弹出确认提示，防止误操作 |
| 默认环境设置 | P1 | 可设置软件启动时的默认环境 |
| 环境锁定 | P1 | 管理员可锁定为仅私域环境模式 |

**环境切换规则**：
- 公网 → 私域：直接切换，提示"已切换到私域环境"
- 私域 → 公网：弹出警告"切换到公网环境可能导致数据上传至云端，请确认当前文档不含敏感信息"
- 切换时自动保存当前文档

### 4.6 图表绘制模块

#### 4.6.1 架构图生成

**功能描述**：根据文档内容自动生成或辅助绘制架构图。

| 功能点 | 优先级 | 详细描述 |
|--------|--------|----------|
| AI生成架构图 | P1 | 根据文字描述自动生成架构图 |
| 模板库 | P1 | 提供常用架构图模板 |
| 可视化编辑 | P0 | 拖拽式编辑图表元素 |
| 样式调整 | P1 | 调整颜色、线条、字体等样式 |
| 图表导出 | P0 | 导出为PNG、SVG等格式 |

#### 4.6.2 原理图/流程图

**功能描述**：支持绘制和编辑原理图、流程图。

| 图表类型 | 优先级 | 适用场景 |
|----------|--------|----------|
| 流程图 | P0 | 工作流程、审批流程等 |
| 组织架构图 | P1 | 部门架构、人员组织等 |
| 思维导图 | P1 | 内容规划、要点梳理等 |
| 时间轴 | P2 | 项目进度、历史沿革等 |
| 关系图 | P2 | 人物关系、业务关联等 |

#### 4.6.3 图文联动

**功能描述**：实现图表与文档内容的联动。

| 功能点 | 优先级 | 详细描述 |
|--------|--------|----------|
| 一键插入 | P0 | 将图表直接插入文档指定位置 |
| 尺寸适配 | P1 | 自动调整图表尺寸适应文档版式 |
| 更新同步 | P2 | 图表修改后可同步更新文档中的图片 |
| 图表管理 | P1 | 管理文档中的所有图表 |

---

## 5. 非功能需求

### 5.1 性能要求

| 指标 | 要求 | 说明 |
|------|------|------|
| 启动时间 | ≤3秒 | 软件从启动到可用状态 |
| 文档打开 | ≤2秒 | 打开50页以内的文档 |
| AI响应时间 | ≤10秒 | 公网AI首次响应时间 |
| 本地AI响应 | ≤30秒 | 本地AI首次响应时间（取决于硬件） |
| 导出时间 | ≤5秒 | 导出50页文档为PDF |
| 内存占用 | ≤500MB | 常规使用时的内存占用 |

### 5.2 安全要求

| 安全项 | 要求 | 说明 |
|--------|------|------|
| 数据传输加密 | TLS 1.2+ | 公网通信必须使用加密传输 |
| API密钥存储 | 加密存储 | 用户API密钥使用AES-256加密存储 |
| 本地数据保护 | 可选加密 | 支持对本地文档进行加密存储 |
| 操作日志 | 完整记录 | 记录关键操作日志，便于审计 |
| 敏感信息检测 | 自动检测 | 公网环境下自动检测敏感信息并提醒 |

### 5.3 可用性要求

| 要求项 | 详细描述 |
|--------|----------|
| 易学性 | 新用户30分钟内能够完成基本公文编写 |
| 易用性 | 核心功能操作步骤不超过3步 |
| 容错性 | 提供操作撤销、自动保存功能 |
| 帮助系统 | 提供完整的帮助文档和操作引导 |
| 无障碍 | 支持键盘操作，兼顾无障碍访问需求 |

### 5.4 兼容性要求

| 兼容项 | 要求 |
|--------|------|
| 操作系统 | Windows 10/11、macOS 12+、主流Linux发行版 |
| 文档格式 | 兼容 Microsoft Word 2016及以上版本格式 |
| 浏览器（如Web版） | Chrome 90+、Edge 90+、Firefox 90+ |
| 屏幕分辨率 | 最低支持1366×768，推荐1920×1080 |

---

## 6. 界面设计要求

### 6.1 公私域环境视觉区分方案（核心设计）

这是本产品最重要的界面设计要求，必须让用户在任何时刻都能清晰识别当前所处的环境。

#### 6.1.1 颜色方案

| 环境 | 主色调 | 辅助色 | 状态栏颜色 |
|------|--------|--------|------------|
| 公网环境 | 蓝色 (#1890FF) | 浅蓝色 (#E6F7FF) | 蓝色渐变 |
| 私域环境 | 绿色 (#52C41A) | 浅绿色 (#F6FFED) | 绿色渐变 |

#### 6.1.2 视觉标识元素

**公网环境标识**：
- 顶部状态栏：蓝色背景，显示"公网环境"文字
- 环境图标：云朵图标
- 边框效果：编辑区蓝色细边框
- 水印提示：可选显示"公网环境"水印

**私域环境标识**：
- 顶部状态栏：绿色背景，显示"私域环境 - 数据本地处理"文字
- 环境图标：盾牌/锁图标
- 边框效果：编辑区绿色细边框
- 安全标识：显示"本地安全"角标

#### 6.1.3 切换交互设计

```
切换按钮位置：顶部状态栏右侧
切换动效：颜色渐变过渡（300ms）
切换确认：私域→公网需二次确认
```

### 6.2 整体界面布局

```
+----------------------------------------------------------------------+
|  [环境状态栏 - 公网蓝色/私域绿色]                [环境切换] [设置]    |
+----------------------------------------------------------------------+
|    |        |                                      |                 |
| 活 | [导航] |          [主编辑区]                  |   [AI助手面板]  |
| 动 |  栏    |                                      |                 |
| 栏 |        |                                      |   - 内容生成    |
|    | - 文档 |                                      |   - 审核建议    |
| 📄 | - 模板 |                                      |   - 对话交互    |
| 📋 | - 历史 |                                      |                 |
| 🕐 |        |                                      |                 |
| ⭐ |        |                                      |                 |
| 📦 |        |                                      |                 |
| 📊 |        |                                      |                 |
| ── |        |                                      |                 |
| ⚙️ |        |                                      |                 |
+----------------------------------------------------------------------+
|  [状态信息]  [字数统计]  [保存状态]             [AI状态] [环境提示]   |
+----------------------------------------------------------------------+
```

### 6.3 活动栏设计（核心交互）

活动栏是界面最左侧的垂直图标栏，用于在不同功能模块之间快速切换。

#### 6.3.1 活动栏功能配置

| 图标 | 功能 | 说明 | 优先级 |
|------|------|------|--------|
| 📄 | 我的文档 | 文档列表管理，查看和管理所有文档 | P0 |
| 📋 | 模板库 | 公文模板浏览和选择 | P0 |
| 🕐 | 最近使用 | 快速访问最近编辑的文档 | P0 |
| ⭐ | 收藏 | 查看收藏的文档和模板 | P1 |
| 📦 | 素材库 | 管理常用短语、段落模板、图片素材等 | P0 |
| 📊 | 图表 | 图表绘制工具 | P1 |
| ⚙️ | 设置 | 应用设置（固定在底部） | P0 |

#### 6.3.2 活动栏交互规则

| 交互行为 | 描述 |
|----------|------|
| 点击图标 | 切换侧边栏显示对应功能面板内容 |
| 选中状态 | 当前选中的图标显示左侧指示条（主题色）和高亮背景 |
| 再次点击选中项 | 折叠/展开侧边栏 |
| 悬停 | 显示功能名称 Tooltip |
| 环境联动 | 指示条颜色跟随当前环境（公网蓝/私域绿） |

#### 6.3.3 活动栏视觉规范

| 属性 | 规格 |
|------|------|
| 宽度 | 48px（固定） |
| 图标尺寸 | 24px |
| 图标间距 | 4px |
| 选中指示条 | 2px宽，主题色 |
| 背景色 | #FFFFFF（与主背景一致） |
| 边框 | 右侧1px边框，#D9D9D9 |

### 6.4 关键界面设计原则

| 原则 | 说明 |
|------|------|
| 环境感知优先 | 任何界面都必须清晰展示当前环境状态 |
| 简洁专业 | 界面风格简洁专业，符合办公场景 |
| 高效操作 | 常用功能触手可及，减少操作层级 |
| 信息分层 | 合理组织信息层级，避免认知负担 |
| 一致性 | 保持交互方式和视觉风格的一致性 |

### 6.5 响应式设计

| 窗口尺寸 | 布局调整 |
|----------|----------|
| ≥1920px | 三栏布局，完整显示所有面板 |
| 1366-1919px | 三栏布局，AI面板可折叠 |
| <1366px | 双栏布局，AI面板改为弹出式 |

---

## 7. 技术架构建议

### 7.1 整体架构设计

```
+------------------------------------------------------------------+
|                        用户界面层 (UI Layer)                      |
|              桌面客户端 (Electron/Tauri) / Web端                   |
+------------------------------------------------------------------+
                               ↓
+------------------------------------------------------------------+
|                       业务逻辑层 (Business Layer)                 |
|   文档管理 | 模板管理 | AI调度 | 格式处理 | 图表引擎 | 审核引擎  |
+------------------------------------------------------------------+
                               ↓
+------------------------------------------------------------------+
|                      AI服务抽象层 (AI Abstraction)                |
|                    统一接口 | 负载均衡 | 故障转移                 |
+----------------------------------+-------------------------------+
                |                                    |
    +-----------v-----------+           +-----------v-----------+
    |     公网AI服务         |           |     本地AI服务         |
    |   OpenAI / Claude     |           |   Ollama / LM Studio  |
    |   国产大模型API        |           |   自定义本地服务       |
    +-----------------------+           +-----------------------+
                               ↓
+------------------------------------------------------------------+
|                       数据存储层 (Data Layer)                     |
|           本地存储 (SQLite) | 云同步 (可选) | 加密存储             |
+------------------------------------------------------------------+
```

### 7.2 AI接口抽象层设计

为支持多种AI服务，需设计统一的AI接口抽象层：

**核心接口**：
- `generateContent(prompt, options)` - 内容生成
- `reviewContent(content, rules)` - 内容审核
- `improveContent(content, instruction)` - 内容优化
- `generateChart(description, type)` - 图表生成

**适配器模式**：
- OpenAIAdapter
- ClaudeAdapter
- QwenAdapter
- OllamaAdapter
- CustomAdapter

### 7.3 本地AI运行环境

**推荐方案**：
- 主推方案：Ollama（跨平台、易部署、模型丰富）
- 备选方案：LM Studio（GUI友好）

**部署要求**：
- 最低配置：8GB内存，支持7B参数模型
- 推荐配置：16GB内存 + NVIDIA GPU，支持13B+参数模型
- 推荐模型：Qwen-7B-Chat、ChatGLM3-6B、Llama-2-7B-Chat

### 7.4 数据安全架构

```
+------------------------+      +------------------------+
|      公网环境          |      |      私域环境          |
+------------------------+      +------------------------+
| 数据流向：             |      | 数据流向：             |
| 用户输入               |      | 用户输入               |
|    ↓                   |      |    ↓                   |
| 敏感信息检测           |      | 本地AI处理             |
|    ↓                   |      |    ↓                   |
| TLS加密传输            |      | 结果返回（不经过网络） |
|    ↓                   |      |    ↓                   |
| 云端AI处理             |      | 本地存储               |
|    ↓                   |      +------------------------+
| 结果返回               |
+------------------------+
```

---

## 8. 数据安全设计

### 8.1 敏感信息识别

系统应具备自动识别敏感信息的能力：

| 敏感类型 | 识别规则 | 处理方式 |
|----------|----------|----------|
| 身份证号 | 正则匹配18位/15位 | 警告提示 |
| 手机号码 | 正则匹配11位手机号 | 警告提示 |
| 银行卡号 | 正则匹配16-19位 | 警告提示 |
| 涉密关键词 | 关键词库匹配 | 阻止并警告 |
| 内部文件号 | 自定义规则 | 警告提示 |

### 8.2 数据流向控制

| 场景 | 公网环境 | 私域环境 |
|------|----------|----------|
| 文档内容 | 需用户确认后上传 | 仅本地处理 |
| 用户配置 | 本地存储 | 本地存储 |
| AI对话记录 | 可选云端/本地 | 仅本地存储 |
| 导出文件 | 本地保存 | 本地保存 |

### 8.3 隔离机制设计

**网络隔离**：
- 私域环境下禁用所有公网AI接口
- 私域环境下阻止向公网发送任何文档内容

**数据隔离**：
- 公网环境文档和私域环境文档分开存储
- 防止误操作将私域文档在公网环境打开

**权限隔离**：
- 支持管理员强制设置为仅私域模式
- 支持按用户角色配置可用环境

---

## 9. 项目里程碑

### 9.1 阶段划分

| 阶段 | 里程碑 | 核心交付物 | 预计周期 |
|------|--------|------------|----------|
| M1 | 基础框架 | 软件框架、基础UI、活动栏、环境切换机制 | 4周 |
| M2 | 核心编辑 | 公文模板、编辑器、格式输出 | 6周 |
| M3 | 文档管理 | 文档列表、分类管理、版本管理、素材库 | 4周 |
| M4 | AI集成 | 公网AI接入、本地AI接入、AI辅助编写 | 6周 |
| M5 | 审核功能 | AI审核、格式检查、审核报告 | 4周 |
| M6 | 图表功能 | 图表绘制、AI生成图表 | 4周 |
| M7 | 完善优化 | 性能优化、安全加固、用户测试 | 4周 |

### 9.2 功能优先级排序

**P0（必须实现）**：
- 公私域环境切换与视觉区分
- 活动栏导航与侧边栏切换
- 基础公文模板与编辑
- 文档管理（列表、分类、搜索）
- 素材库基础功能（常用短语、图片素材）
- 多格式导出（DOCX、PDF）
- 公网AI集成（至少支持一种）
- 本地AI集成（Ollama）
- 基础审核功能

**P1（应该实现）**：
- 完整的模板管理系统
- 文档版本管理
- 素材库完整功能（段落模板、表格模板）
- 多种公网AI支持
- 详细的审核报告
- 基础图表绘制

**P2（可以延后）**：
- 高级图表功能
- 团队协作功能
- 云端同步
- 更多输出格式
- 素材库高级功能（智能推荐、使用统计）

---

## 10. 附录

### 10.1 公文格式标准速查

| 项目 | 标准要求 |
|------|----------|
| 正文字体 | 仿宋_GB2312 或 仿宋 |
| 正文字号 | 三号（16pt） |
| 标题字体 | 方正小标宋 或 黑体 |
| 标题字号 | 二号（22pt） |
| 行距 | 固定值28-30磅 |
| 页边距 | 上37mm 下35mm 左28mm 右26mm |
| 纸张 | A4 (210mm × 297mm) |

### 10.2 竞品参考

| 产品 | 优势 | 劣势 |
|------|------|------|
| WPS AI | 国产、生态完善 | 无明确公私隔离 |
| 腾讯文档AI | 协作能力强 | 数据在云端 |
| 通用AI写作工具 | 功能丰富 | 不针对公文场景 |

**RedInk差异化优势**：专注公文场景 + 公私隔离设计

### 10.3 术语表补充

| 术语 | 英文 | 说明 |
|------|------|------|
| PRD | Product Requirements Document | 产品需求文档 |
| MVP | Minimum Viable Product | 最小可行产品 |
| API | Application Programming Interface | 应用程序接口 |
| LLM | Large Language Model | 大语言模型 |
| GGUF | GPT-Generated Unified Format | 一种模型格式 |

---

**文档结束**

---
