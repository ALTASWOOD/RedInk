# 用例文档

## 文档信息

| 项目 | 内容 |
|------|------|
| 文档版本 | V1.0 |
| 文档状态 | 已完成 |
| 创建日期 | 2026-02-28 |
| 最后更新 | 2026-02-28 |

---

## 目录

1. [用例概述](#1-用例概述)
2. [参与者定义](#2-参与者定义)
3. [公文编写用例](#3-公文编写用例)
4. [文档管理用例](#4-文档管理用例)
5. [AI功能用例](#5-ai功能用例)
6. [环境切换用例](#6-环境切换用例)
7. [系统设置用例](#7-系统设置用例)

---

## 1. 用例概述

### 1.1 用例图

```
                    ┌─────────────────────────────────────────────────┐
                    │               RedInk 公文编写系统                 │
                    │                                                   │
                    │  ┌─────────────┐    ┌─────────────┐              │
                    │  │  创建公文   │    │  编辑公文   │              │
                    │  └──────┬──────┘    └──────┬──────┘              │
                    │         │                   │                     │
     ┌────────┐     │  ┌──────┴───────────────────┴──────┐             │
     │  用户  │─────│──│       使用AI辅助编写             │             │
     └────────┘     │  └─────────────────────────────────┘             │
                    │                                                   │
                    │  ┌─────────────┐    ┌─────────────┐              │
                    │  │  AI审核     │    │  导出文档   │              │
                    │  └─────────────┘    └─────────────┘              │
                    │                                                   │
                    │  ┌─────────────┐    ┌─────────────┐              │
                    │  │ 环境切换    │    │  系统设置   │              │
                    │  └─────────────┘    └─────────────┘              │
                    │                                                   │
                    └─────────────────────────────────────────────────┘
```

### 1.2 用例列表

| 用例ID | 用例名称 | 优先级 | 复杂度 |
|--------|----------|--------|--------|
| UC01 | 创建公文 | P0 | 中 |
| UC02 | 编辑公文 | P0 | 高 |
| UC03 | 使用AI生成内容 | P0 | 高 |
| UC04 | 切换公网/私域环境 | P0 | 低 |
| UC05 | AI审核文档 | P0 | 中 |
| UC06 | 导出文档 | P0 | 低 |
| UC07 | 管理文档 | P0 | 中 |
| UC08 | 管理模板 | P1 | 中 |
| UC09 | 绘制图表 | P1 | 高 |
| UC10 | 配置AI服务 | P1 | 中 |
| UC11 | 使用素材库 | P0 | 低 |

---

## 2. 参与者定义

### 2.1 主要参与者

| 参与者 | 描述 | 典型用户 |
|--------|------|----------|
| 普通用户 | 使用系统进行公文编写的终端用户 | 文秘、行政人员 |
| 管理员 | 负责系统配置和安全策略的管理人员 | IT管理员 |

### 2.2 外部系统

| 系统 | 描述 |
|------|------|
| 公网AI服务 | OpenAI、Claude、通义千问等云端AI服务 |
| 本地AI服务 | Ollama、LM Studio等本地部署的AI服务 |
| 文件系统 | 本地文件系统，用于导入导出文档 |

---

## 3. 公文编写用例

### UC01 创建公文

**用例标识**：UC01

**用例名称**：创建公文

**参与者**：普通用户

**前置条件**：
- 用户已启动应用
- 当前环境已确定（公网或私域）

**后置条件**：
- 新文档已创建并保存到数据库
- 文档显示在编辑区

**基本流程**：

| 步骤 | 用户操作 | 系统响应 |
|------|----------|----------|
| 1 | 点击"新建文档"按钮 | 显示模板选择对话框 |
| 2 | 选择公文类型和模板 | 显示模板预览 |
| 3 | 点击"确认"按钮 | 创建新文档，加载模板内容 |
| 4 | - | 打开文档编辑器 |
| 5 | - | 在侧边栏显示新文档 |

**替代流程**：

| 分支 | 条件 | 处理 |
|------|------|------|
| 2a | 用户选择"空白文档" | 创建无模板的空白文档 |
| 2b | 用户点击"取消" | 关闭对话框，不创建文档 |

**业务规则**：
- BR-UC01-01：新文档自动关联当前环境（公网/私域）
- BR-UC01-02：文档标题默认为"未命名文档"
- BR-UC01-03：自动记录创建时间

---

### UC02 编辑公文

**用例标识**：UC02

**用例名称**：编辑公文

**参与者**：普通用户

**前置条件**：
- 文档已打开或已创建

**后置条件**：
- 文档内容已更新
- 自动保存已执行

**基本流程**：

| 步骤 | 用户操作 | 系统响应 |
|------|----------|----------|
| 1 | 在编辑器中输入或修改内容 | 实时显示输入内容 |
| 2 | 使用工具栏设置格式 | 应用格式到选中内容 |
| 3 | - | 每30秒自动保存 |
| 4 | 按Ctrl+S或点击保存 | 立即保存并创建版本 |
| 5 | - | 显示"已保存"状态 |

**替代流程**：

| 分支 | 条件 | 处理 |
|------|------|------|
| 3a | 网络断开（公网环境） | 提示离线状态，暂停AI功能 |
| 4a | 保存失败 | 显示错误信息，保留本地副本 |

**扩展点**：
- EP-01：插入素材（链接UC11）
- EP-02：使用AI辅助（链接UC03）
- EP-03：插入图表（链接UC09）

---

## 4. 文档管理用例

### UC07 管理文档

**用例标识**：UC07

**用例名称**：管理文档

**参与者**：普通用户

**前置条件**：
- 用户已登录系统

**后置条件**：
- 文档列表状态更新

**基本流程**：

| 步骤 | 用户操作 | 系统响应 |
|------|----------|----------|
| 1 | 点击"我的文档"按钮 | 显示文档列表 |
| 2 | 使用筛选条件筛选 | 刷新文档列表 |
| 3 | 在搜索框输入关键词 | 显示搜索结果 |
| 4 | 双击文档 | 打开文档编辑器 |

**替代流程**：

| 分支 | 条件 | 处理 |
|------|------|------|
| 4a | 右键点击文档 | 显示上下文菜单（重命名、删除、收藏等） |
| 4b | 选择"删除" | 显示确认对话框，确认后移入回收站 |
| 4c | 选择"导出" | 跳转到UC06导出文档 |

**子用例**：

#### UC07.1 创建文件夹

| 步骤 | 操作 | 响应 |
|------|------|------|
| 1 | 右键点击空白处 | 显示菜单 |
| 2 | 选择"新建文件夹" | 显示命名对话框 |
| 3 | 输入文件夹名称 | 创建文件夹 |

#### UC07.2 移动文档

| 步骤 | 操作 | 响应 |
|------|------|------|
| 1 | 拖拽文档到目标文件夹 | 高亮目标文件夹 |
| 2 | 释放鼠标 | 移动文档到目标文件夹 |

---

### UC08 管理模板

**用例标识**：UC08

**用例名称**：管理模板

**参与者**：普通用户

**前置条件**：
- 用户已登录系统

**后置条件**：
- 模板库状态更新

**基本流程**：

| 步骤 | 用户操作 | 系统响应 |
|------|----------|----------|
| 1 | 点击"模板库"按钮 | 显示模板列表 |
| 2 | 按分类浏览模板 | 显示对应分类的模板 |
| 3 | 点击模板卡片 | 显示模板预览 |
| 4 | 点击"使用此模板" | 创建基于此模板的新文档 |

**替代流程**：

| 分支 | 条件 | 处理 |
|------|------|------|
| 4a | 点击"编辑模板"（自定义模板） | 打开模板编辑器 |
| 4b | 点击"复制模板"（内置模板） | 创建模板副本供编辑 |

---

## 5. AI功能用例

### UC03 使用AI生成内容

**用例标识**：UC03

**用例名称**：使用AI生成内容

**参与者**：普通用户

**前置条件**：
- 文档已打开
- AI服务已配置且可用
- 当前环境对应的AI服务已连接

**后置条件**：
- AI生成的内容插入到文档
- AI会话记录已保存

**基本流程**：

| 步骤 | 用户操作 | 系统响应 |
|------|----------|----------|
| 1 | 点击AI助手面板 | 展开AI助手面板 |
| 2 | 选择"内容生成"功能 | 显示内容生成表单 |
| 3 | 输入主题和要点 | - |
| 4 | 点击"生成"按钮 | 显示加载状态 |
| 5 | - | 调用AI服务生成内容 |
| 6 | - | 显示生成结果预览 |
| 7 | 点击"插入"按钮 | 将内容插入到文档光标位置 |

**替代流程**：

| 分支 | 条件 | 处理 |
|------|------|------|
| 5a | AI服务超时 | 显示超时提示，提供重试选项 |
| 5b | AI服务不可用 | 显示服务不可用提示 |
| 6a | 用户不满意结果 | 点击"重新生成"获取新结果 |
| 6b | 用户选择"多方案" | 显示多个生成方案供选择 |
| 7a | 用户点击"编辑后插入" | 先编辑生成内容再插入 |

**业务规则**：
- BR-UC03-01：私域环境仅调用本地AI服务
- BR-UC03-02：AI生成内容标记来源（AI生成）
- BR-UC03-03：记录AI会话用于审计

---

### UC05 AI审核文档

**用例标识**：UC05

**用例名称**：AI审核文档

**参与者**：普通用户

**前置条件**：
- 文档已打开且有内容
- AI服务已配置且可用

**后置条件**：
- 审核报告已生成
- 审核记录已保存

**基本流程**：

| 步骤 | 用户操作 | 系统响应 |
|------|----------|----------|
| 1 | 点击"AI审核"按钮 | 显示审核选项 |
| 2 | 选择审核类型（内容/格式/全面） | - |
| 3 | 点击"开始审核" | 显示审核进度 |
| 4 | - | 调用AI进行内容审核 |
| 5 | - | 执行格式检查 |
| 6 | - | 生成审核报告 |
| 7 | - | 显示审核结果面板 |
| 8 | 点击问题项 | 定位到文档对应位置 |
| 9 | 点击"一键修复" | 自动修复可修复的问题 |

**替代流程**：

| 分支 | 条件 | 处理 |
|------|------|------|
| 4a | 审核超时 | 显示超时提示，展示已完成的部分结果 |
| 9a | 部分问题无法自动修复 | 仅修复可修复项，标记需手动处理项 |

**审核报告内容**：

| 内容项 | 说明 |
|--------|------|
| 总体评分 | 0-100分 |
| 通过状态 | 通过/不通过 |
| 问题统计 | 高/中/低严重度问题数量 |
| 问题列表 | 每个问题的详情和建议 |

---

## 6. 环境切换用例

### UC04 切换公网/私域环境

**用例标识**：UC04

**用例名称**：切换公网/私域环境

**参与者**：普通用户

**前置条件**：
- 用户已登录系统
- 目标环境的AI服务已配置

**后置条件**：
- 界面主题切换为对应颜色
- AI服务切换为对应环境的服务
- 文档列表切换为对应环境的文档

**基本流程（公网→私域）**：

| 步骤 | 用户操作 | 系统响应 |
|------|----------|----------|
| 1 | 点击环境切换按钮 | 显示切换选项 |
| 2 | 选择"私域环境" | - |
| 3 | - | 保存当前文档 |
| 4 | - | 界面颜色切换为绿色 |
| 5 | - | 显示"已切换到私域环境"提示 |
| 6 | - | 切换AI服务为本地服务 |
| 7 | - | 刷新文档列表（显示私域文档） |

**基本流程（私域→公网）**：

| 步骤 | 用户操作 | 系统响应 |
|------|----------|----------|
| 1 | 点击环境切换按钮 | 显示切换选项 |
| 2 | 选择"公网环境" | 显示警告对话框 |
| 3 | 阅读警告信息 | - |
| 4 | 点击"确认切换" | 保存当前文档 |
| 5 | - | 界面颜色切换为蓝色 |
| 6 | - | 显示"已切换到公网环境"提示 |
| 7 | - | 切换AI服务为公网服务 |
| 8 | - | 刷新文档列表（显示公网文档） |

**替代流程**：

| 分支 | 条件 | 处理 |
|------|------|------|
| 4a（私域→公网） | 用户点击"取消" | 保持当前私域环境 |
| 6a | 目标环境AI服务未配置 | 显示配置引导 |

**警告对话框内容**（私域→公网）：
```
⚠️ 切换到公网环境确认

您正在切换到公网环境，请注意：
• 公网环境的AI服务会通过互联网传输数据
• 请确保当前及后续编辑的文档不包含敏感信息
• 私域环境的文档不会在公网环境显示

是否确认切换到公网环境？

[取消] [确认切换]
```

---

## 7. 系统设置用例

### UC10 配置AI服务

**用例标识**：UC10

**用例名称**：配置AI服务

**参与者**：普通用户/管理员

**前置条件**：
- 用户已进入设置页面

**后置条件**：
- AI服务配置已保存
- 配置的服务可用

**基本流程**：

| 步骤 | 用户操作 | 系统响应 |
|------|----------|----------|
| 1 | 进入"设置 > AI设置" | 显示AI配置页面 |
| 2 | 点击"添加AI服务" | 显示服务配置表单 |
| 3 | 选择服务提供商 | 加载对应配置模板 |
| 4 | 填写API地址和密钥 | - |
| 5 | 点击"测试连接" | 发起连接测试 |
| 6 | - | 显示测试结果 |
| 7 | 点击"保存" | 保存配置（密钥加密存储） |
| 8 | - | 服务添加到可用列表 |

**替代流程**：

| 分支 | 条件 | 处理 |
|------|------|------|
| 6a | 连接测试失败 | 显示错误信息，提供排查建议 |
| 7a | 配置本地AI服务 | 检测本地服务是否运行 |

---

### UC06 导出文档

**用例标识**：UC06

**用例名称**：导出文档

**参与者**：普通用户

**前置条件**：
- 文档已打开或已选择

**后置条件**：
- 文档已导出到指定位置

**基本流程**：

| 步骤 | 用户操作 | 系统响应 |
|------|----------|----------|
| 1 | 点击"导出"按钮 | 显示导出选项 |
| 2 | 选择导出格式 | 显示格式特定选项 |
| 3 | 配置导出参数 | - |
| 4 | 点击"导出" | 显示文件保存对话框 |
| 5 | 选择保存位置和文件名 | - |
| 6 | 点击"保存" | 执行导出 |
| 7 | - | 显示导出进度 |
| 8 | - | 显示导出成功提示 |

**导出格式选项**：

| 格式 | 可配置项 |
|------|----------|
| DOCX | 是否包含批注、是否兼容旧版Word |
| PDF | 是否包含书签、图片质量 |
| Markdown | 是否包含样式、图片处理方式 |

---

### UC11 使用素材库

**用例标识**：UC11

**用例名称**：使用素材库

**参与者**：普通用户

**前置条件**：
- 文档正在编辑中

**后置条件**：
- 素材已插入到文档

**基本流程**：

| 步骤 | 用户操作 | 系统响应 |
|------|----------|----------|
| 1 | 点击"素材库"按钮 | 显示素材库面板 |
| 2 | 选择素材类型 | 显示对应类型素材列表 |
| 3 | 搜索或浏览素材 | 显示匹配结果 |
| 4 | 点击素材 | 显示素材预览 |
| 5 | 点击"插入"按钮 | 将素材插入到光标位置 |
| 6 | - | 更新素材使用次数 |

**素材类型操作**：

| 素材类型 | 插入方式 |
|----------|----------|
| 常用短语 | 直接插入文本 |
| 段落模板 | 显示变量填写表单，填写后插入 |
| 图片素材 | 插入图片，可调整尺寸 |
| 表格模板 | 插入表格结构 |

---

### UC09 绘制图表

**用例标识**：UC09

**用例名称**：绘制图表

**参与者**：普通用户

**前置条件**：
- 文档已打开

**后置条件**：
- 图表已创建并可选择插入文档

**基本流程**：

| 步骤 | 用户操作 | 系统响应 |
|------|----------|----------|
| 1 | 点击"图表"按钮 | 显示图表面板 |
| 2 | 选择图表类型 | 显示图表编辑器 |
| 3 | 编辑图表内容 | 实时预览图表 |
| 4 | 调整图表样式 | 更新图表显示 |
| 5 | 点击"插入到文档" | 将图表插入到文档 |

**替代流程**：

| 分支 | 条件 | 处理 |
|------|------|------|
| 2a | 选择"AI生成图表" | 显示描述输入框 |
| 2b | 输入图表描述 | AI生成图表初稿 |
| 5a | 点击"导出图片" | 将图表导出为PNG/SVG |

---

## 附录：用例-功能追溯矩阵

| 用例 | F-DOC | F-MGT | F-MAT | F-AUD | F-AI | F-CHT | F-SET |
|------|-------|-------|-------|-------|------|-------|-------|
| UC01 | ✓ | ✓ | - | - | - | - | - |
| UC02 | ✓ | - | ✓ | - | ✓ | - | - |
| UC03 | ✓ | - | - | - | ✓ | - | - |
| UC04 | - | - | - | - | ✓ | - | ✓ |
| UC05 | - | - | - | ✓ | ✓ | - | - |
| UC06 | ✓ | - | - | - | - | - | - |
| UC07 | - | ✓ | - | - | - | - | - |
| UC08 | ✓ | - | - | - | - | - | - |
| UC09 | - | - | - | - | ✓ | ✓ | - |
| UC10 | - | - | - | - | ✓ | - | ✓ |
| UC11 | ✓ | - | ✓ | - | - | - | - |

---

*文档结束*
