# 功能规格说明书

## 文档信息

| 项目 | 内容 |
|------|------|
| 文档版本 | V1.0 |
| 文档状态 | 已完成 |
| 创建日期 | 2026-02-28 |
| 最后更新 | 2026-02-28 |

---

## 目录

1. [公文编写模块功能规格](#1-公文编写模块功能规格)
2. [文档管理模块功能规格](#2-文档管理模块功能规格)
3. [素材库管理模块功能规格](#3-素材库管理模块功能规格)
4. [AI审核模块功能规格](#4-ai审核模块功能规格)
5. [AI集成模块功能规格](#5-ai集成模块功能规格)
6. [图表绘制模块功能规格](#6-图表绘制模块功能规格)
7. [系统设置功能规格](#7-系统设置功能规格)

---

## 1. 公文编写模块功能规格

### 1.1 公文模板管理

#### 1.1.1 功能标识
- **功能ID**：F-DOC-001
- **功能名称**：公文模板管理
- **优先级**：P0

#### 1.1.2 功能描述
提供标准公文模板库，支持模板的浏览、选择、使用、自定义和导入导出。

#### 1.1.3 输入规格

| 输入项 | 数据类型 | 必填 | 说明 |
|--------|----------|------|------|
| 模板名称 | String | 是 | 长度1-50字符 |
| 模板分类 | Enum | 是 | notice/report/request/reply/letter/minutes |
| 模板内容 | JSON | 是 | 符合模板内容结构定义 |
| 格式配置 | JSON | 否 | 字体、字号、行距等格式参数 |
| 示例内容 | String | 否 | 模板使用示例 |

#### 1.1.4 输出规格

| 输出项 | 数据类型 | 说明 |
|--------|----------|------|
| 模板ID | String | UUID格式 |
| 操作结果 | Boolean | 成功/失败 |
| 错误信息 | String | 失败时返回具体错误 |

#### 1.1.5 业务规则

| 规则编号 | 规则描述 |
|----------|----------|
| BR-001 | 内置模板不可删除，可复制后修改 |
| BR-002 | 模板名称在同一分类下不可重复 |
| BR-003 | 删除模板不影响已使用该模板创建的文档 |
| BR-004 | 模板使用次数自动统计 |

#### 1.1.6 预置模板类型

| 模板类型 | 类型代码 | 说明 |
|----------|----------|------|
| 通知 | notice | 用于发布通知、公告 |
| 报告 | report | 工作报告、汇报材料 |
| 请示 | request | 向上级请示事项 |
| 批复 | reply | 对下级请示的答复 |
| 函件 | letter | 平级单位之间的往来文书 |
| 会议纪要 | minutes | 会议记录和决议 |

---

### 1.2 AI辅助编写

#### 1.2.1 功能标识
- **功能ID**：F-DOC-002
- **功能名称**：AI辅助编写
- **优先级**：P0

#### 1.2.2 功能描述
利用AI技术辅助用户完成公文内容的生成、续写、改写和优化。

#### 1.2.3 子功能规格

##### 1.2.3.1 内容生成 (F-DOC-002-01)

| 项目 | 说明 |
|------|------|
| 输入 | 公文类型、主题、要点列表、背景信息 |
| 输出 | 结构完整的公文初稿 |
| 约束 | 生成内容符合所选公文类型的格式规范 |
| 响应时间 | 公网环境≤10秒，私域环境≤30秒 |

##### 1.2.3.2 智能续写 (F-DOC-002-02)

| 项目 | 说明 |
|------|------|
| 输入 | 已有内容、光标位置 |
| 输出 | 后续段落内容 |
| 约束 | 续写内容与已有内容语义连贯 |
| 响应时间 | 公网环境≤8秒，私域环境≤25秒 |

##### 1.2.3.3 内容改写 (F-DOC-002-03)

| 项目 | 说明 |
|------|------|
| 输入 | 选中文本、改写指令（润色/精简/扩展/正式化） |
| 输出 | 改写后的文本 |
| 约束 | 保持原文核心意思不变 |
| 响应时间 | 公网环境≤5秒，私域环境≤15秒 |

##### 1.2.3.4 多方案生成 (F-DOC-002-04)

| 项目 | 说明 |
|------|------|
| 输入 | 内容生成请求 |
| 输出 | 2-3个不同风格的方案 |
| 约束 | 各方案风格有明显差异 |

#### 1.2.4 业务规则

| 规则编号 | 规则描述 |
|----------|----------|
| BR-010 | AI生成内容需标记为"AI生成"，便于用户识别 |
| BR-011 | 用户可对AI生成内容进行采纳、修改或拒绝 |
| BR-012 | 私域环境下AI调用不经过公网 |
| BR-013 | 记录AI会话用于后续优化和审计 |

---

### 1.3 多格式输出

#### 1.3.1 功能标识
- **功能ID**：F-DOC-003
- **功能名称**：多格式输出
- **优先级**：P0

#### 1.3.2 支持格式规格

| 格式 | 扩展名 | 优先级 | 规格说明 |
|------|--------|--------|----------|
| Word文档 | .docx | P0 | 符合Office Open XML标准，兼容Word 2016+ |
| PDF文档 | .pdf | P0 | PDF 1.7标准，支持书签和目录 |
| Markdown | .md | P1 | 标准Markdown语法，支持表格扩展 |
| HTML | .html | P2 | HTML5标准，可嵌入样式 |
| OFD | .ofd | P2 | 国产版式文档格式 |

#### 1.3.3 DOCX输出规格

| 规格项 | 要求 |
|--------|------|
| 标题字体 | 方正小标宋或黑体，二号（22pt） |
| 正文字体 | 仿宋_GB2312或仿宋，三号（16pt） |
| 行距 | 固定值28-30磅 |
| 页边距 | 上37mm 下35mm 左28mm 右26mm |
| 纸张 | A4 (210mm × 297mm) |

---

## 2. 文档管理模块功能规格

### 2.1 文档列表管理

#### 2.1.1 功能标识
- **功能ID**：F-MGT-001
- **功能名称**：文档列表管理
- **优先级**：P0

#### 2.1.2 列表字段规格

| 字段名 | 显示名 | 类型 | 排序 | 筛选 |
|--------|--------|------|------|------|
| title | 标题 | String | 支持 | 支持 |
| doc_type | 类型 | Enum | 支持 | 支持 |
| status | 状态 | Enum | 支持 | 支持 |
| environment | 环境 | Enum | 不支持 | 支持 |
| updated_at | 修改时间 | DateTime | 支持 | 支持 |
| word_count | 字数 | Number | 支持 | 不支持 |

#### 2.1.3 筛选条件规格

| 筛选项 | 类型 | 可选值 |
|--------|------|--------|
| 文档类型 | 多选 | 通知、报告、请示、批复、函、会议纪要 |
| 文档状态 | 多选 | 草稿、审核中、已完成 |
| 环境 | 单选 | 全部、公网、私域 |
| 时间范围 | 日期范围 | 开始日期-结束日期 |

#### 2.1.4 搜索功能规格

| 规格项 | 说明 |
|--------|------|
| 搜索范围 | 标题、正文内容 |
| 搜索方式 | 全文搜索，支持模糊匹配 |
| 搜索结果 | 高亮匹配关键词 |
| 响应时间 | ≤500ms（1000文档内） |

---

### 2.2 文档分类管理

#### 2.2.1 功能标识
- **功能ID**：F-MGT-002
- **功能名称**：文档分类管理
- **优先级**：P0

#### 2.2.2 分类结构规格

| 分类方式 | 说明 | 层级 |
|----------|------|------|
| 文件夹 | 用户自定义文件夹 | 最多3级 |
| 标签 | 自由添加标签 | 单层，每文档最多10个 |
| 收藏 | 收藏夹快速访问 | 单层 |
| 回收站 | 已删除文档 | 单层，保留30天 |

#### 2.2.3 特殊视图规格

| 视图名称 | 数据来源 | 排序方式 |
|----------|----------|----------|
| 最近使用 | 按访问时间 | 访问时间降序，最多50条 |
| 收藏文档 | 已收藏文档 | 收藏时间降序 |
| 公网文档 | environment=public | 修改时间降序 |
| 私域文档 | environment=private | 修改时间降序 |

---

### 2.3 文档版本管理

#### 2.3.1 功能标识
- **功能ID**：F-MGT-003
- **功能名称**：文档版本管理
- **优先级**：P1

#### 2.3.2 版本管理规格

| 规格项 | 说明 |
|--------|------|
| 自动保存间隔 | 30秒（编辑时） |
| 版本创建条件 | 手动保存、退出编辑、间隔5分钟自动 |
| 最大版本数 | 每文档保留最近50个版本 |
| 版本信息 | 保存时间、内容快照、字数变化 |

#### 2.3.3 版本对比规格

| 对比项 | 说明 |
|--------|------|
| 对比方式 | 并排对比、行内差异标记 |
| 差异标记 | 新增（绿色）、删除（红色）、修改（黄色） |
| 对比范围 | 任意两个版本 |

---

## 3. 素材库管理模块功能规格

### 3.1 常用短语管理

#### 3.1.1 功能标识
- **功能ID**：F-MAT-001
- **功能名称**：常用短语管理
- **优先级**：P0

#### 3.1.2 短语分类规格

| 分类 | 说明 | 预置数量 |
|------|------|----------|
| 开头语 | 公文开头常用表述 | 20+ |
| 结束语 | 公文结尾常用表述 | 15+ |
| 过渡语 | 段落衔接用语 | 15+ |
| 请示用语 | 请示类公文用语 | 10+ |
| 批复用语 | 批复类公文用语 | 10+ |
| 通知用语 | 通知类公文用语 | 10+ |

#### 3.1.3 短语属性规格

| 属性 | 类型 | 必填 | 说明 |
|------|------|------|------|
| 内容 | String | 是 | 短语文本，最长500字符 |
| 分类 | Enum | 是 | 所属分类 |
| 标签 | Array | 否 | 自定义标签 |
| 使用次数 | Number | 自动 | 系统自动统计 |
| 是否内置 | Boolean | 自动 | 标识预置短语 |

---

### 3.2 段落模板管理

#### 3.2.1 功能标识
- **功能ID**：F-MAT-002
- **功能名称**：段落模板管理
- **优先级**：P1

#### 3.2.2 段落模板规格

| 属性 | 说明 |
|------|------|
| 模板内容 | 支持变量占位符 `{{变量名}}` |
| 变量定义 | 名称、类型、默认值、必填标识 |
| 适用类型 | 指定适用的公文类型 |

#### 3.2.3 变量类型规格

| 变量类型 | 示例 | 说明 |
|----------|------|------|
| text | `{{单位名称}}` | 文本输入 |
| date | `{{发文日期}}` | 日期选择 |
| number | `{{参会人数}}` | 数字输入 |
| select | `{{审批结果}}` | 下拉选择 |

---

### 3.3 图片素材管理

#### 3.3.1 功能标识
- **功能ID**：F-MAT-003
- **功能名称**：图片素材管理
- **优先级**：P0

#### 3.3.2 图片规格要求

| 规格项 | 要求 |
|--------|------|
| 支持格式 | PNG、JPG、JPEG、SVG |
| 最大尺寸 | 单张10MB |
| 存储上限 | 总计500MB |
| 分类 | 公章、签名、配图、图标 |

---

## 4. AI审核模块功能规格

### 4.1 内容审核

#### 4.1.1 功能标识
- **功能ID**：F-AUD-001
- **功能名称**：内容审核
- **优先级**：P0

#### 4.1.2 审核项规格

| 审核项 | 检查内容 | 严重级别 |
|--------|----------|----------|
| 逻辑检查 | 文章结构、论述逻辑 | 中 |
| 事实核查 | 数据一致性、日期准确性 | 高 |
| 政策合规 | 政策法规符合性 | 高 |
| 敏感词检测 | 敏感词、不当表述 | 高 |
| 语病检查 | 语法错误、病句 | 低 |
| 重复检查 | 冗余表述、重复内容 | 低 |

#### 4.1.3 审核结果规格

| 字段 | 类型 | 说明 |
|------|------|------|
| passed | Boolean | 是否通过 |
| score | Number | 得分（0-100） |
| issues | Array | 问题列表 |
| suggestions | Array | 修改建议 |

---

### 4.2 格式审核

#### 4.2.1 功能标识
- **功能ID**：F-AUD-002
- **功能名称**：格式审核
- **优先级**：P0

#### 4.2.2 格式检查项

| 检查项 | 标准值 | 容差 |
|--------|--------|------|
| 标题字号 | 二号（22pt） | ±1pt |
| 正文字号 | 三号（16pt） | ±1pt |
| 行距 | 28-30磅 | 固定值 |
| 段落首行缩进 | 2字符 | 精确匹配 |
| 页边距-上 | 37mm | ±2mm |
| 页边距-下 | 35mm | ±2mm |
| 页边距-左 | 28mm | ±2mm |
| 页边距-右 | 26mm | ±2mm |

---

### 4.3 审核报告

#### 4.3.1 功能标识
- **功能ID**：F-AUD-003
- **功能名称**：审核报告
- **优先级**：P1

#### 4.3.2 报告内容规格

| 内容模块 | 说明 |
|----------|------|
| 概览 | 总体得分、通过/不通过状态 |
| 问题统计 | 按严重程度分类统计 |
| 问题列表 | 详细问题描述、位置、建议 |
| 快速修复 | 可自动修复的问题列表 |

---

## 5. AI集成模块功能规格

### 5.1 AI提供商配置

#### 5.1.1 功能标识
- **功能ID**：F-AI-001
- **功能名称**：AI提供商配置
- **优先级**：P0

#### 5.1.2 支持的AI提供商

| 提供商 | 类型 | 优先级 | 说明 |
|--------|------|--------|------|
| OpenAI | 公网 | P1 | GPT-3.5/GPT-4系列 |
| Claude | 公网 | P1 | Claude 2/3系列 |
| 通义千问 | 公网 | P0 | 阿里云大模型 |
| 文心一言 | 公网 | P0 | 百度大模型 |
| Ollama | 私域 | P0 | 本地模型服务 |
| LM Studio | 私域 | P1 | 本地模型GUI |

#### 5.1.3 配置项规格

| 配置项 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| API地址 | URL | 是 | 服务端点地址 |
| API密钥 | String | 公网必填 | 加密存储 |
| 模型名称 | String | 是 | 使用的模型标识 |
| 温度参数 | Number | 否 | 0.0-1.0，默认0.7 |
| 最大Token | Number | 否 | 单次请求最大Token |

---

### 5.2 公网/私域环境切换

#### 5.2.1 功能标识
- **功能ID**：F-AI-002
- **功能名称**：公网/私域环境切换
- **优先级**：P0（核心特性）

#### 5.2.2 环境定义

| 环境 | 标识 | 颜色 | AI服务 |
|------|------|------|--------|
| 公网环境 | public | 蓝色 (#1890FF) | 云端AI服务 |
| 私域环境 | private | 绿色 (#52C41A) | 本地AI服务 |

#### 5.2.3 切换规则

| 切换方向 | 操作 | 确认 |
|----------|------|------|
| 公网→私域 | 直接切换 | 提示"已切换到私域环境" |
| 私域→公网 | 二次确认 | 警告对话框，需用户确认 |

#### 5.2.4 环境限制

| 限制项 | 公网环境 | 私域环境 |
|--------|----------|----------|
| AI服务 | 云端API | 仅本地服务 |
| 数据传输 | 经过公网 | 仅本地 |
| 文档访问 | 仅公网文档 | 仅私域文档 |

---

## 6. 图表绘制模块功能规格

### 6.1 图表类型

#### 6.1.1 功能标识
- **功能ID**：F-CHT-001
- **功能名称**：图表绘制
- **优先级**：P1

#### 6.1.2 支持的图表类型

| 图表类型 | 类型代码 | 优先级 | 用途 |
|----------|----------|--------|------|
| 流程图 | flowchart | P0 | 工作流程、审批流程 |
| 组织架构图 | orgchart | P1 | 部门架构、人员组织 |
| 思维导图 | mindmap | P1 | 内容规划、要点梳理 |
| 时间轴 | timeline | P2 | 项目进度、历史沿革 |
| 关系图 | relation | P2 | 人物关系、业务关联 |

#### 6.1.3 图表编辑规格

| 功能 | 说明 |
|------|------|
| 拖拽编辑 | 支持节点拖拽、连线调整 |
| 样式调整 | 颜色、字体、线条样式 |
| 自动布局 | 支持多种自动布局算法 |
| 撤销重做 | 支持多步撤销/重做 |

#### 6.1.4 导出规格

| 导出格式 | 说明 |
|----------|------|
| PNG | 位图格式，支持透明背景 |
| SVG | 矢量格式，无损缩放 |
| 插入文档 | 直接插入到当前文档 |

---

## 7. 系统设置功能规格

### 7.1 常规设置

#### 7.1.1 功能标识
- **功能ID**：F-SET-001
- **功能名称**：常规设置
- **优先级**：P0

#### 7.1.2 设置项规格

| 设置项 | 类型 | 默认值 | 说明 |
|--------|------|--------|------|
| 默认环境 | Enum | private | 启动时默认环境 |
| 自动保存 | Boolean | true | 是否启用自动保存 |
| 保存间隔 | Number | 30 | 自动保存间隔（秒） |
| 语言 | Enum | zh-CN | 界面语言 |
| 主题 | Enum | auto | 跟随系统/亮色/暗色 |

---

### 7.2 AI设置

#### 7.2.1 功能标识
- **功能ID**：F-SET-002
- **功能名称**：AI设置
- **优先级**：P0

#### 7.2.2 设置项规格

| 设置项 | 类型 | 说明 |
|--------|------|------|
| 公网AI提供商 | Enum | 当前使用的公网AI |
| 私域AI提供商 | Enum | 当前使用的私域AI |
| API配置列表 | Array | 已配置的API列表 |
| 默认温度 | Number | AI生成温度参数 |

---

### 7.3 安全设置

#### 7.3.1 功能标识
- **功能ID**：F-SET-003
- **功能名称**：安全设置
- **优先级**：P1

#### 7.3.2 设置项规格

| 设置项 | 类型 | 说明 |
|--------|------|------|
| 文档加密 | Boolean | 是否加密存储文档 |
| 敏感词检测 | Boolean | 公网环境是否检测敏感词 |
| 操作日志 | Boolean | 是否记录操作日志 |
| 日志保留天数 | Number | 日志保留时长（默认90天） |

---

*文档结束*
