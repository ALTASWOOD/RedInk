# 版本升级指南

## 文档信息

| 项目 | 内容 |
|------|------|
| 文档版本 | V1.0 |
| 创建日期 | 2026-02-28 |

---

## 1. 升级策略

### 1.1 版本号规则

```
主版本.次版本.修订版本
  v1    .0     .0

- 主版本: 不兼容的重大更新
- 次版本: 向下兼容的新功能
- 修订版本: Bug修复和小改进
```

### 1.2 升级兼容性

| 升级类型 | 数据迁移 | 配置变更 |
|----------|----------|----------|
| 修订版本 | 自动 | 无 |
| 次版本 | 自动 | 可能 |
| 主版本 | 需确认 | 需要 |

---

## 2. 升级步骤

### 2.1 升级前准备

```bash
# 1. 备份数据
# Windows
xcopy "%APPDATA%\com.redink.app" "C:\backup\redink" /E /I

# macOS/Linux
cp -r ~/Library/Application\ Support/com.redink.app ~/backup/redink

# 2. 记录当前版本
# 在应用 设置 > 关于 中查看
```

### 2.2 执行升级

**Windows:**
```
1. 下载新版本 MSI/EXE
2. 直接运行安装程序 (覆盖安装)
3. 重新启动应用
```

**macOS:**
```
1. 下载新版本 DMG
2. 将新版 App 拖入 Applications 覆盖
3. 重新启动应用
```

**Linux:**
```bash
# DEB
sudo dpkg -i redink_new_version.deb

# AppImage
rm old_version.AppImage
chmod +x new_version.AppImage
```

### 2.3 升级后检查

- [ ] 应用正常启动
- [ ] 历史文档可正常打开
- [ ] AI服务连接正常
- [ ] 配置设置保持

---

## 3. 数据迁移

### 3.1 自动迁移

应用启动时自动检测并执行数据库迁移:

```
检测数据库版本 → 执行迁移脚本 → 更新版本号
```

### 3.2 手动迁移 (主版本升级)

```bash
# 导出旧版数据
redink-cli export --output backup.json

# 安装新版本

# 导入数据
redink-cli import --input backup.json
```

---

## 4. 回滚方案

### 4.1 回滚步骤

```bash
# 1. 卸载新版本
# 2. 安装旧版本
# 3. 恢复备份数据
cp -r ~/backup/redink/* ~/.local/share/com.redink.app/
```

### 4.2 注意事项

- 主版本降级可能导致数据不兼容
- 建议保留多个版本的备份

---

## 5. 版本历史

| 版本 | 日期 | 主要变更 |
|------|------|----------|
| v1.0.0 | 2026-03-xx | 首个正式版本 |
| v0.9.0 | 2026-02-xx | Beta测试版 |

---

*文档结束*
