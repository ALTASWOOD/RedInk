# 测试用例

## 文档信息

| 项目 | 内容 |
|------|------|
| 文档版本 | V1.0 |
| 文档状态 | 已完成 |
| 创建日期 | 2026-02-28 |
| 最后更新 | 2026-02-28 |

---

## 1. 文档管理模块

### 1.1 文档创建

| 用例ID | TC-DOC-001 |
|--------|------------|
| 用例名称 | 创建新文档 |
| 前置条件 | 用户已登录系统 |
| 测试步骤 | 1. 点击"新建"按钮<br>2. 选择文档类型"通知"<br>3. 输入标题<br>4. 点击确认 |
| 预期结果 | 文档创建成功，进入编辑界面 |
| 优先级 | P0 |

| 用例ID | TC-DOC-002 |
|--------|------------|
| 用例名称 | 使用模板创建文档 |
| 前置条件 | 系统存在可用模板 |
| 测试步骤 | 1. 点击"新建"按钮<br>2. 选择"使用模板"<br>3. 选择通知模板<br>4. 点击使用 |
| 预期结果 | 文档创建成功，内容包含模板结构 |
| 优先级 | P1 |

### 1.2 文档编辑

| 用例ID | TC-DOC-003 |
|--------|------------|
| 用例名称 | 编辑文档内容 |
| 前置条件 | 已打开文档 |
| 测试步骤 | 1. 在编辑区输入文字<br>2. 选中文字设置加粗<br>3. 添加段落 |
| 预期结果 | 内容编辑正确，格式应用成功 |
| 优先级 | P0 |

| 用例ID | TC-DOC-004 |
|--------|------------|
| 用例名称 | 撤销/重做操作 |
| 前置条件 | 已进行编辑操作 |
| 测试步骤 | 1. 输入文字"测试"<br>2. 按Ctrl+Z撤销<br>3. 按Ctrl+Y重做 |
| 预期结果 | 撤销后文字消失，重做后文字恢复 |
| 优先级 | P1 |

| 用例ID | TC-DOC-005 |
|--------|------------|
| 用例名称 | 自动保存功能 |
| 前置条件 | 文档已创建，自动保存已开启 |
| 测试步骤 | 1. 编辑文档内容<br>2. 等待30秒<br>3. 检查保存状态 |
| 预期结果 | 状态栏显示"已保存"，数据库记录更新 |
| 优先级 | P1 |

### 1.3 文档保存

| 用例ID | TC-DOC-006 |
|--------|------------|
| 用例名称 | 手动保存文档 |
| 前置条件 | 文档有未保存的修改 |
| 测试步骤 | 1. 点击保存按钮<br>2. 或按Ctrl+S |
| 预期结果 | 保存成功，状态栏显示保存时间 |
| 优先级 | P0 |

| 用例ID | TC-DOC-007 |
|--------|------------|
| 用例名称 | 退出时未保存提醒 |
| 前置条件 | 文档有未保存的修改 |
| 测试步骤 | 1. 编辑文档但不保存<br>2. 尝试关闭窗口 |
| 预期结果 | 弹出保存提醒对话框 |
| 优先级 | P1 |

### 1.4 文档删除

| 用例ID | TC-DOC-008 |
|--------|------------|
| 用例名称 | 删除文档(软删除) |
| 前置条件 | 文档列表有文档 |
| 测试步骤 | 1. 右键选择文档<br>2. 点击"移至回收站" |
| 预期结果 | 文档从列表消失，出现在回收站 |
| 优先级 | P1 |

| 用例ID | TC-DOC-009 |
|--------|------------|
| 用例名称 | 从回收站恢复文档 |
| 前置条件 | 回收站有文档 |
| 测试步骤 | 1. 打开回收站<br>2. 选择文档点击恢复 |
| 预期结果 | 文档恢复到文档列表 |
| 优先级 | P2 |

---

## 2. AI功能模块

### 2.1 AI内容生成

| 用例ID | TC-AI-001 |
|--------|-----------|
| 用例名称 | AI生成通知内容 |
| 前置条件 | AI服务可用，已选择文档类型 |
| 测试步骤 | 1. 选择AI面板"生成"标签<br>2. 选择"通知"类型<br>3. 输入要点"年度会议，3月15日"<br>4. 点击生成 |
| 预期结果 | 显示生成进度，完成后显示通知内容 |
| 优先级 | P0 |

| 用例ID | TC-AI-002 |
|--------|-----------|
| 用例名称 | AI流式输出显示 |
| 前置条件 | AI服务可用 |
| 测试步骤 | 1. 发起AI生成请求<br>2. 观察输出过程 |
| 预期结果 | 内容逐字显示，有光标闪烁效果 |
| 优先级 | P1 |

| 用例ID | TC-AI-003 |
|--------|-----------|
| 用例名称 | 停止AI生成 |
| 前置条件 | AI正在生成中 |
| 测试步骤 | 1. 生成过程中点击停止按钮 |
| 预期结果 | 生成立即停止，已输出内容保留 |
| 优先级 | P1 |

| 用例ID | TC-AI-004 |
|--------|-----------|
| 用例名称 | 插入AI生成内容到文档 |
| 前置条件 | AI已生成内容 |
| 测试步骤 | 1. 生成完成后点击"插入到文档" |
| 预期结果 | 内容插入到当前文档光标位置 |
| 优先级 | P0 |

### 2.2 AI内容审核

| 用例ID | TC-AI-005 |
|--------|-----------|
| 用例名称 | 审核文档格式 |
| 前置条件 | 文档有内容 |
| 测试步骤 | 1. 切换到"审核"标签<br>2. 勾选"格式审核"<br>3. 点击开始审核 |
| 预期结果 | 显示格式问题列表和修改建议 |
| 优先级 | P0 |

| 用例ID | TC-AI-006 |
|--------|-----------|
| 用例名称 | 定位审核问题 |
| 前置条件 | 审核结果包含问题 |
| 测试步骤 | 1. 点击问题项的"定位"按钮 |
| 预期结果 | 编辑器滚动到问题位置并高亮 |
| 优先级 | P1 |

| 用例ID | TC-AI-007 |
|--------|-----------|
| 用例名称 | 一键修复问题 |
| 前置条件 | 存在可自动修复的问题 |
| 测试步骤 | 1. 点击"一键修复" |
| 预期结果 | 可自动修复的问题被修正 |
| 优先级 | P1 |

### 2.3 AI内容改写

| 用例ID | TC-AI-008 |
|--------|-----------|
| 用例名称 | 改写选中文本 |
| 前置条件 | 编辑器中有选中文本 |
| 测试步骤 | 1. 选中一段文字<br>2. 切换到"改写"标签<br>3. 选择"润色"风格<br>4. 点击改写 |
| 预期结果 | 显示改写结果和对比 |
| 优先级 | P1 |

---

## 3. 环境切换模块

### 3.1 环境识别

| 用例ID | TC-ENV-001 |
|--------|------------|
| 用例名称 | 私域环境标识显示 |
| 前置条件 | 当前为私域环境 |
| 测试步骤 | 1. 观察顶部状态栏 |
| 预期结果 | 显示绿色主题，盾牌图标，"私域环境"文字 |
| 优先级 | P0 |

| 用例ID | TC-ENV-002 |
|--------|------------|
| 用例名称 | 公网环境标识显示 |
| 前置条件 | 当前为公网环境 |
| 测试步骤 | 1. 观察顶部状态栏 |
| 预期结果 | 显示蓝色主题，云朵图标，"公网环境"文字 |
| 优先级 | P0 |

### 3.2 环境切换

| 用例ID | TC-ENV-003 |
|--------|------------|
| 用例名称 | 私域切换到公网 |
| 前置条件 | 当前为私域环境 |
| 测试步骤 | 1. 点击"切换到公网"按钮<br>2. 在确认对话框点击确认 |
| 预期结果 | 显示安全确认对话框，确认后切换成功，界面变为蓝色 |
| 优先级 | P0 |

| 用例ID | TC-ENV-004 |
|--------|------------|
| 用例名称 | 公网切换到私域 |
| 前置条件 | 当前为公网环境 |
| 测试步骤 | 1. 点击"切换到私域"按钮 |
| 预期结果 | 直接切换成功（无确认），界面变为绿色 |
| 优先级 | P0 |

| 用例ID | TC-ENV-005 |
|--------|------------|
| 用例名称 | 取消环境切换 |
| 前置条件 | 当前为私域环境 |
| 测试步骤 | 1. 点击"切换到公网"<br>2. 在确认对话框点击取消 |
| 预期结果 | 对话框关闭，环境保持不变 |
| 优先级 | P1 |

---

## 4. 安全功能模块

### 4.1 敏感信息检测

| 用例ID | TC-SEC-001 |
|--------|------------|
| 用例名称 | 检测身份证号 |
| 前置条件 | 启用敏感检测 |
| 测试步骤 | 1. 在公网环境输入包含身份证号的内容<br>2. 尝试发送给AI |
| 预期结果 | 检测到敏感信息，显示警告 |
| 优先级 | P0 |

| 用例ID | TC-SEC-002 |
|--------|------------|
| 用例名称 | 检测手机号码 |
| 前置条件 | 启用敏感检测 |
| 测试步骤 | 1. 输入"联系人:13800138000"<br>2. 尝试发送给AI |
| 预期结果 | 检测到手机号，提示脱敏建议 |
| 优先级 | P0 |

| 用例ID | TC-SEC-003 |
|--------|------------|
| 用例名称 | 私域环境无敏感检测 |
| 前置条件 | 当前为私域环境 |
| 测试步骤 | 1. 输入包含身份证号的内容<br>2. 发送给本地AI |
| 预期结果 | 正常发送，不触发敏感检测 |
| 优先级 | P1 |

### 4.2 网络隔离

| 用例ID | TC-SEC-004 |
|--------|------------|
| 用例名称 | 私域环境阻止公网请求 |
| 前置条件 | 当前为私域环境 |
| 测试步骤 | 1. 尝试调用公网AI服务 |
| 预期结果 | 请求被阻止，显示错误提示 |
| 优先级 | P0 |

---

## 5. 导出功能模块

### 5.1 文档导出

| 用例ID | TC-EXP-001 |
|--------|------------|
| 用例名称 | 导出为DOCX |
| 前置条件 | 文档有内容 |
| 测试步骤 | 1. 点击导出按钮<br>2. 选择DOCX格式<br>3. 选择保存路径<br>4. 点击导出 |
| 预期结果 | 导出成功，生成的Word文档格式正确 |
| 优先级 | P0 |

| 用例ID | TC-EXP-002 |
|--------|------------|
| 用例名称 | 导出为PDF |
| 前置条件 | 文档有内容 |
| 测试步骤 | 1. 选择PDF格式导出 |
| 预期结果 | 导出成功，PDF格式正确可阅读 |
| 优先级 | P0 |

| 用例ID | TC-EXP-003 |
|--------|------------|
| 用例名称 | 导出使用公文格式 |
| 前置条件 | 勾选"使用标准公文格式" |
| 测试步骤 | 1. 导出文档<br>2. 打开导出文件检查格式 |
| 预期结果 | 格式符合GB/T 9704标准 |
| 优先级 | P1 |

---

## 6. 模板管理模块

### 6.1 模板操作

| 用例ID | TC-TPL-001 |
|--------|------------|
| 用例名称 | 查看内置模板 |
| 前置条件 | - |
| 测试步骤 | 1. 打开模板库 |
| 预期结果 | 显示所有内置模板分类 |
| 优先级 | P1 |

| 用例ID | TC-TPL-002 |
|--------|------------|
| 用例名称 | 创建自定义模板 |
| 前置条件 | - |
| 测试步骤 | 1. 点击创建模板<br>2. 填写模板信息<br>3. 设置模板内容<br>4. 保存 |
| 预期结果 | 模板创建成功，出现在"我的模板" |
| 优先级 | P1 |

| 用例ID | TC-TPL-003 |
|--------|------------|
| 用例名称 | 收藏模板 |
| 前置条件 | 模板库有模板 |
| 测试步骤 | 1. 点击模板的收藏按钮 |
| 预期结果 | 模板添加到收藏，图标变化 |
| 优先级 | P2 |

---

## 7. 图表绘制模块

### 7.1 图表创建

| 用例ID | TC-CHT-001 |
|--------|------------|
| 用例名称 | 创建流程图 |
| 前置条件 | 在编辑文档 |
| 测试步骤 | 1. 点击插入图表<br>2. 选择流程图<br>3. 添加节点和连线<br>4. 保存 |
| 预期结果 | 流程图创建成功，可插入文档 |
| 优先级 | P1 |

| 用例ID | TC-CHT-002 |
|--------|------------|
| 用例名称 | AI生成组织架构图 |
| 前置条件 | AI服务可用 |
| 测试步骤 | 1. 选择组织架构图<br>2. 输入"公司有3个部门：研发、市场、财务"<br>3. 点击AI生成 |
| 预期结果 | 生成对应结构的组织架构图 |
| 优先级 | P1 |

---

## 8. 设置功能模块

### 8.1 AI配置

| 用例ID | TC-SET-001 |
|--------|------------|
| 用例名称 | 配置Ollama服务 |
| 前置条件 | Ollama已安装 |
| 测试步骤 | 1. 打开设置>AI服务<br>2. 选择私域服务类型Ollama<br>3. 输入服务地址<br>4. 点击测试连接 |
| 预期结果 | 显示连接成功状态 |
| 优先级 | P0 |

| 用例ID | TC-SET-002 |
|--------|------------|
| 用例名称 | 配置公网API Key |
| 前置条件 | 有有效的API Key |
| 测试步骤 | 1. 选择公网AI服务商<br>2. 输入API Key<br>3. 保存 |
| 预期结果 | Key加密保存，测试连接成功 |
| 优先级 | P0 |

### 8.2 安全设置

| 用例ID | TC-SET-003 |
|--------|------------|
| 用例名称 | 开启/关闭敏感检测 |
| 前置条件 | - |
| 测试步骤 | 1. 打开设置>安全设置<br>2. 切换敏感检测开关 |
| 预期结果 | 设置生效，重启后保持 |
| 优先级 | P1 |

| 用例ID | TC-SET-004 |
|--------|------------|
| 用例名称 | 设置默认启动环境 |
| 前置条件 | - |
| 测试步骤 | 1. 设置默认环境为"私域"<br>2. 重启应用 |
| 预期结果 | 应用启动后默认为私域环境 |
| 优先级 | P1 |

---

## 9. 兼容性测试

### 9.1 平台兼容

| 用例ID | TC-CMP-001 |
|--------|------------|
| 用例名称 | Windows平台运行 |
| 前置条件 | Windows 10/11系统 |
| 测试步骤 | 1. 安装应用<br>2. 运行各项功能 |
| 预期结果 | 所有功能正常 |
| 优先级 | P0 |

| 用例ID | TC-CMP-002 |
|--------|------------|
| 用例名称 | macOS平台运行 |
| 前置条件 | macOS 12+系统 |
| 测试步骤 | 1. 安装应用<br>2. 运行各项功能 |
| 预期结果 | 所有功能正常 |
| 优先级 | P0 |

| 用例ID | TC-CMP-003 |
|--------|------------|
| 用例名称 | Linux平台运行 |
| 前置条件 | Ubuntu 22.04 |
| 测试步骤 | 1. 安装应用<br>2. 运行各项功能 |
| 预期结果 | 所有功能正常 |
| 优先级 | P1 |

---

*文档结束*
